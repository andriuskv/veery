(()=>{"use strict";var e,t,n,i={55:(e,t,n)=>{n.d(t,{$j:()=>y,Kw:()=>b,L$:()=>u,TT:()=>d,VN:()=>f,yo:()=>p});var i=n(806),r=n(244),a=n(400);const o="documentPictureInPicture"in window;let s=null,l="",c={};function d(){return o}function u(e){s?s.close():async function({paused:e,track:t,togglePlay:n,playNext:i,playPrevious:r}){s=await window.documentPictureInPicture.requestWindow(),c={togglePlay:n,playNext:i,playPrevious:r},await async function(e){const t=[...document.styleSheets].map(t=>{try{return[...t.cssRules].map(e=>e.cssText).join("")}catch(n){const i=document.createElement("link");return i.rel="stylesheet",i.type=t.type,i.media=t.media,i.href=t.href,e.appendChild(i),null}}).filter(Boolean).join("\n"),n=document.createElement("style");n.textContent=t,e.appendChild(n)}(s.document.head),s.document.head.insertAdjacentHTML("beforeend",'\n    <style>\n      body {\n        overflow: hidden;\n        display: flex;\n        align-items: flex-end;\n      }\n\n      body:is(:hover, :has(:focus-visible)) #bottom-bar {\n        opacity: 1;\n        transform: none;\n      }\n\n      body:is(:hover, :has(:focus-visible)) #artwork-overlay {\n        opacity: 1;\n      }\n\n      #artwork-background {\n        z-index: -1;\n        position: absolute;\n        transform: scale(1.08);\n        width: 100%;\n        height: 100%;\n        background-repeat: no-repeat;\n        background-size: cover;\n        background-position: center;\n        filter: blur(16px);\n      }\n\n      #artwork {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        display: block;\n        height: calc(100% + 40px);\n        object-fit: scale-down;\n        border-radius: 8px;\n      }\n\n      #artwork.shadow {\n        box-shadow:\n          1px 2px 2px var(--color-black-100-16),\n          2px 4px 4px var(--color-black-100-8),\n          4px 8px 8px var(--color-black-100-4),\n          8px 16px 16px var(--color-black-100-2);\n      }\n\n      #artwork-overlay {\n        position: absolute;\n        inset: 0;\n        content: "";\n        display: block;\n        background-image: linear-gradient(rgb(0 0 0 / 0%), rgb(0 0 0 / 16%), rgb(0 0 0 / 40%));\n        opacity: 0;\n        transition: 0.2s opacity;\n        pointer-events: none;\n      }\n\n      #bottom-bar {\n        position: relative;\n        transform: translateY(8px);\n        opacity: 0;\n        width: 100%;\n        padding: 0 var(--space-xl);\n        transition: 0.2s opacity, 0.2s transform;\n      }\n\n      .track-info-item {\n        display: -webkit-box;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 2;\n        white-space: normal;\n        text-shadow: 1px 2px 2px var(--color-black-100-16);\n        text-wrap: balance;\n        color: var(--color-white);\n        text-align: center;\n      }\n\n      .track-artist {\n        margin-top: var(--space-sm);\n        font-size: var(--text-xs);\n      }\n\n      #controls {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        margin-top: var(--space-xl);\n        margin-bottom: var(--space-xl);\n      }\n\n      .player-bar-play-pause-btn svg {\n        width: 36px;\n        height: 36px;\n      }\n    </style>\n  '),s.document.body.insertAdjacentHTML("beforeend",`\n    <svg style="display:none;">\n      <symbol id="play-circle" viewBox="0 0 24 24">\n        <path d="M10,16.5V7.5L16,12M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>\n      </symbol>\n      <symbol id="pause-circle" viewBox="0 0 24 24">\n        <path d="M15,16H13V8H15M11,16H9V8H11M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>\n      </symbol>\n      <symbol id="previous" viewBox="0 0 24 24">\n        <path d="M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z"/>\n      </symbol>\n      <symbol id="next" viewBox="0 0 24 24">\n        <path d="M16,18H18V6H16M6,18L14.5,12L6,6V18Z"/>\n      </symbol>\n    </svg>\n    <div id="artwork-background"></div>\n    <img id="artwork" src="" alt="" draggable="false">\n    <div id="artwork-overlay"></div>\n    <div id="bottom-bar">\n      <div id="track-title" class="track-info-item"></div>\n      <div id="controls">\n        <button data-action="previous" class="btn icon-btn player-bar-secondary-btn">${(0,a.sW)({iconId:"previous"})}</button>\n        <button class="btn icon-btn player-bar-play-pause-btn" data-action="play-pause">\n          ${(0,a.sW)({iconId:e?"play-circle":"pause-circle"})}\n        </button>\n        <button data-action="next" class="btn icon-btn player-bar-secondary-btn">${(0,a.sW)({iconId:"next"})}</button>\n      </div>\n    </div>\n  `),s.document.getElementById("controls").addEventListener("click",e=>{const t=e.target.closest("button");if(t){const e=t.getAttribute("data-action");"play-pause"===e?c.togglePlay():"next"===e?c.playNext():"previous"===e&&c.playPrevious()}}),s.addEventListener("unload",m,{once:!0}),p(t,e)}(e)}function f(){s&&(s.close(),m())}function m(){(0,i.w3)("pip-close"),s=null,c={},l=""}function p(e,t){s&&(v(e.artist&&e.title?`${e.artist} - ${e.title}`:e.title,t),function(e){const{isPlaceholder:t,original:n}=(0,r.TT)(e),i=s.document.getElementById("artwork");s.document.getElementById("artwork-background").style.backgroundImage=`url(${n.url})`,i.src=n.url,t?i.classList.remove("shadow"):i.classList.add("shadow")}(e.artworkId),function(e){const t=s.document.getElementById("track-title"),n=s.document.getElementById("track-artist");t.textContent=e.title,e.artist?n?n.textContent=e.artist:t.insertAdjacentHTML("afterend",`<div id="track-artist" class="track-info-item track-artist">${e.artist}</div>`):n&&n.remove()}(e))}function v(e,t){l=e,s&&(s.document.title=t?`Paused - ${e}`:`Playing - ${e}`)}function y(e){if(!s)return;s.document.getElementById("controls").querySelector("[data-action=play-pause]").innerHTML=(0,a.sW)({iconId:e?"play-circle":"pause-circle"}),v(l,e)}function b(e){c=e}},56:(e,t,n)=>{n.d(t,{FZ:()=>a,OM:()=>o,UE:()=>r});let i=JSON.parse(localStorage.getItem("track"));function r(){return i}function a(e,t=!0){i={...i,...e},"local-files"===i.playlistId?localStorage.removeItem("track"):t&&localStorage.setItem("track",JSON.stringify(i))}function o(){i=null,localStorage.removeItem("track")}},123:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(848);function r({id:e,className:t,title:n}){return(0,i.jsxs)("svg",{viewBox:"0 0 24 24",className:t,children:[n&&(0,i.jsx)("title",{children:n}),(0,i.jsx)("use",{href:`#${e}`})]})}},191:(e,t,n)=>{n.d(t,{PL:()=>o,ZC:()=>a,dH:()=>s});const i=Object.assign({repeat:"repeat-off",shuffle:!1,mute:!1,volume:.33},JSON.parse(localStorage.getItem("veery-settings"))||{});let r=0;function a(e,t){i[e]=t,l(i)}function o(e){return i[e]}function s(e){delete i[e],l(i)}function l(e){clearTimeout(r),r=setTimeout(()=>{localStorage.setItem("veery-settings",JSON.stringify(e))},2e3)}},193:(e,t,n)=>{n.d(t,{h:()=>l,p:()=>s});var i=n(540),r=n(806),a=n(848);const o=(0,i.createContext)();function s({children:e}){const[t,n]=(0,i.useState)([]),s=(0,i.useMemo)(()=>({notifications:t,showNotification:u,dismissNotification:m}),[t]),l=(0,i.useRef)(0),c=(0,i.useRef)(null);function d({detail:e}){u(e)}function u(e){return e.id=(0,r.$f)(),c.current(e),e.id}function f(e){const i=t.length+1,r=i-6<0?0:i-6;t.push(e),n([...t.slice(r,i)])}function m(e){const i=t.findIndex(t=>t.id===e);p(i),setTimeout(()=>{t.splice(i,1),n([...t])},400)}function p(e){t[e].hidding=!0,n([...t])}return(0,i.useEffect)(()=>{c.current=f}),(0,i.useEffect)(()=>(clearTimeout(l.current),window.addEventListener("notification",d),t.length&&(l.current=setTimeout(()=>{p(0),setTimeout(()=>{t.shift(),n([...t])},400)},5e3)),()=>{window.removeEventListener("notification",d)}),[t]),(0,a.jsx)(o,{value:s,children:e})}function l(){return(0,i.use)(o)}},244:(e,t,n)=>{n.d(t,{Bu:()=>f,L_:()=>m,TT:()=>d,mN:()=>l,pq:()=>c});var i=n(806),r=n(440);const a={};let o=null,s=0;async function l(e){const t=await e.getAll("artworks");o=e;for(const e of t)a[e.id]=e}function c(e,t,n){a[e]||(t.id=e,a[e]=t,n&&(clearTimeout(s),s=setTimeout(()=>{!async function(e){const t=o.transaction("artworks","readwrite");await Promise.all([...Object.keys(e).map(n=>{const i=e[n];return i.original.blob||i.small.blob?null:t.store.put({id:i.id,original:i.original,small:i.small})}),t.done])}(a)},2e3)))}function d(e){if(e){const t=a[e];if(!t)return u();const{original:n,small:i}=t;return n.blob&&!n.url&&(n.url=URL.createObjectURL(n.blob)),i?i.blob&&!i.url&&(i.url=URL.createObjectURL(i.blob)):t.small={url:n.url},t}return u()}function u(){const e="assets/images/album-art-placeholder.png";return{isPlaceholder:!0,original:{url:e},small:{url:e}}}function f(e){const t="assets/images/album-art-placeholder.png";if(!e.length)return[t];const n=e.reduce((e,t)=>(t.artworkId&&e.push(t),e),[]);if(!n.length)return[t];const r=[];for(const e of(0,i.R3)(n)){if(4===r.length)break;r.includes(e.artworkId)||r.push(e.artworkId)}return r.map(e=>d(e).small.url)}async function m(e){const t=Object.values(e).reduce((e,t)=>e.concat(t.tracks),[]).map(e=>e.artworkId).reduce((e,t)=>(e[t]=e[t]?e[t]+1:1,e),{}),n=(0,r.yu)(),i=o.transaction("artworks","readwrite"),s=[];for(const e of Object.keys(a))t[e]||(n?.artworkId!==e&&delete a[e],s.push(i.store.delete(e)));Promise.all([...s,i.done])}},295:(e,t,n)=>{n.d(t,{F:()=>b,J:()=>y});var i=n(540),r=n(52),a=n(806),o=n(584),s=n(719),l=n(191),c=n(55),d=n(56),u=n(440),f=n(568),m=n(400),p=n(848);const v=(0,i.createContext)();function y({children:e}){const t=(0,r.zy)(),{playlists:n}=(0,o.n)(),{getNextQueueItem:y,getQueueItemAtIndex:b,removePlaylistItems:h,resetQueue:w}=(0,s.x)(),[g,k]=(0,i.useState)(""),[x,T]=(0,i.useState)(null),[j,L]=(0,i.useState)(!0),[E,I]=(0,i.useState)(!1),[N,S]=(0,i.useState)(!1),P=(0,i.useMemo)(()=>({initialized:N,paused:j,activePlaylistId:g,activeTrack:x,trackLoading:E,initTrack:$,togglePlay:q,playPrevious:B,playNext:U,playAtIndex:V,playPlaylist:z,playQueueTrack:F}),[N,j,g,x,E]);async function $(e,t,n=0){const i=await u.Cn(e,t,{currentTime:n,willPlay:!1});T(i),R(t),u.Gx(t,i.index)}function A({detail:{loading:e,paused:t}}){"boolean"==typeof t&&H(t),"boolean"==typeof e&&(I(e),e?(0,m.Eg)():(0,m.$n)())}function M({detail:{track:e,playlistId:t}}){T(e),t!==g&&R(t),I(!0),H(!1),c.yo(e,!1)}function C({detail:e}){const t=(0,l.PL)("repeat");if("repeat-off"===t&&u.Wv())u.GO();else if("repeat-one"!==t||e){const e=y();u.GT(e)}else u._0()}function O(){L(!0),T(null),k(""),I(!1),c.VN()}function R(e){k(e),u.Ay(e)}function H(e){L(e),u.fq(e),(0,m.GV)(e),c.$j(e)}function q(){u.d5(),H(!j)}function B(){if(!g)return;const e=y();u.v_(g)||e&&u.v_(e.playlistId)?u.mb({scrollToTrack:!0}):u.GO()}function U(){if(!g)return;const e=y();u.v_(g)||e&&u.v_(e.playlistId)?u.GT(e,{scrollToTrack:!0}):u.GO()}function V(e,t){u.c6(e,t),w()}function z(e,t){u.v_(e)&&(u.$N(e,t),w())}function F(e,t){const n=b(e);u.V2(n,t)}function D({action:e}){let{currentTime:t}=d.UE();"seekforward"===e?t+=5:"seekbackward"===e&&(t-=5),u.wV(t),(0,a.w3)("current-time-update",t)}function W({seekTime:e}){const t=Math.round(e);u.wV(t),(0,a.w3)("current-time-update",t)}return(0,i.useEffect)(()=>(window.addEventListener("player-state",A),window.addEventListener("reset-player",O),()=>{window.removeEventListener("player-state",A),window.removeEventListener("reset-player",O)}),[]),(0,i.useEffect)(()=>{if(n)if(g&&!n[g]&&(h(g),R((0,a.$f)()),(0,m.cb)()),j){const e=t.pathname.split("/playlist/")[1];if(e){const t=f.LR(e);t?(0,a.wE)(t.title):(0,a.wE)("404")}else if("/"===t.pathname)(0,a.wE)("Home");else if(t.pathname.startsWith("/now-playing"))if(x){const{title:e,artist:t}=x;(0,a.wE)(`Paused - ${t&&e?`${t} - ${e}`:e}`)}else document.title="Veery";else t.pathname.startsWith("/search")?(0,a.wE)("Search"):(0,a.wE)("404")}else{const{title:e,artist:t}=x;(0,a.wE)(t&&e?`${t} - ${e}`:e)}},[n,j,x,t]),(0,i.useEffect)(()=>(window.addEventListener("track-start",M),window.addEventListener("track-end",C),()=>{window.removeEventListener("track-start",M),window.removeEventListener("track-end",C)}),[g]),(0,i.useEffect)(()=>{if(x)return c.Kw({togglePlay:q,playPrevious:B,playNext:U}),navigator.mediaSession.setActionHandler("play",q),navigator.mediaSession.setActionHandler("pause",q),navigator.mediaSession.setActionHandler("previoustrack",B),navigator.mediaSession.setActionHandler("nexttrack",U),navigator.mediaSession.setActionHandler("seekforward",D),navigator.mediaSession.setActionHandler("seekbackward",D),navigator.mediaSession.setActionHandler("seekto",W),()=>{navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekto",null)}},[j,x]),(0,i.useEffect)(()=>{n&&!N&&function(){S(!0);const e=d.UE();if(!e)return;const{playlistId:t,trackId:n,currentTime:i}=e,r=f.LR(t);if(r){const e=r.tracks.find(e=>n===e.id);if(e)return void $(e,t,i)}d.OM()}()},[n]),(0,p.jsx)(v,{value:P,children:e})}function b(){return(0,i.use)(v)}},335:(e,t,n)=>{var i=n(338),r=(n(367),n(52)),a=n(193),o=n(584),s=n(719),l=n(295),c=n(540),d=n(400),u=n(123),f=n(848);const m=function(){const e=(0,r.zy)(),{playlists:t}=(0,o.n)(),{activePlaylistId:n,paused:i}=(0,l.F)(),[a,s]=(0,c.useState)({}),[d,m]=(0,c.useState)(!1),[p,v]=(0,c.useState)(!1);function y({detail:{id:e,visible:t}}){t?s({...a,[e]:t}):(delete a[e],s({...a}))}function b(){m(!0)}function h(){m(!1)}function w(e){const t=n===e&&!i,r=a[e];return t||r?(0,f.jsxs)("div",{className:"sidebar-playlist-status-container",children:[t&&(0,f.jsx)("span",{className:"sidebar-active-playlist-indicator"}),r&&(0,f.jsx)(u.A,{id:"spinner"})]}):null}function g({isActive:e}){let t="btn icon-text-btn sidebar-link";return e&&(t+=" active"),t}return(0,c.useEffect)(()=>(window.addEventListener("update-indicator-status",y),()=>{window.removeEventListener("update-indicator-status",y)}),[]),(0,c.useEffect)(()=>{d&&h(),v(!e.pathname.startsWith("/playlist/"))},[e]),(0,f.jsxs)(f.Fragment,{children:[function(){const e=(0,f.jsx)("button",{onClick:b,className:"btn icon-btn sidebar-show-btn",children:(0,f.jsx)(u.A,{id:"menu"})});return p?(0,f.jsx)("div",{className:"sidebar-toolbar",children:e}):e}(),(0,f.jsx)("div",{className:"sidebar-container"+(d?"":" hidden"),onClick:function(e){e.target===e.currentTarget&&h()},children:(0,f.jsxs)("aside",{className:"sidebar",children:[(0,f.jsx)("header",{className:"sidebar-header",children:(0,f.jsx)("h1",{className:"sidebar-header-title",children:"Veery"})}),(0,f.jsxs)("nav",{className:"sidebar-links",children:[(0,f.jsxs)("ul",{className:"sidebar-general-links",children:[(0,f.jsx)("li",{children:(0,f.jsxs)(r.k2,{to:"/",className:g,draggable:"false",children:[(0,f.jsx)(u.A,{id:"home"}),(0,f.jsx)("span",{children:"Home"})]})}),(0,f.jsx)("li",{children:(0,f.jsxs)(r.k2,{to:"/search",className:g,draggable:"false",children:[(0,f.jsx)(u.A,{id:"search"}),(0,f.jsx)("span",{children:"Search"})]})})]}),t?(0,f.jsx)("ul",{className:"sidebar-playlist-links",children:Object.values(t).map(e=>"search"===e.id?null:(0,f.jsx)("li",{children:(0,f.jsxs)(r.k2,{to:`/playlist/${e.id}`,className:g,draggable:"false",children:[(0,f.jsx)("span",{className:"sidebar-playlist-title",children:e.title}),w(e.id)]})},e.id))}):null]})]})})]})};var p=n(191),v=n(440),y=n(55),b=n(244);const h=function({visible:e,toggleNowPlaying:t,youtubePlayerMaximized:n}){const i=(0,r.Zp)(),{activePlaylistId:a,activeTrack:o}=(0,l.F)();let s="./assets/images/album-art-placeholder.png",c="";function m(){return(0,f.jsx)("button",{className:"btn icon-btn artwork-btn",onClick:t,title:e?"Hide":"Expand",children:(0,f.jsx)(u.A,{id:"menu-down",className:"artwork-btn-icon"+(e?"":" rotated")})},"a")}if(e&&!n)return(0,f.jsx)("div",{className:"player-bar-now-playing",children:(0,f.jsx)("div",{className:"artwork-container player-bar-artwork-container",children:m()})});if(o){const{isPlaceholder:e,small:t}=(0,b.TT)(o.artworkId);s=t.url,c+=" active",e&&(c+=" placeholder")}return(0,f.jsxs)("div",{className:"player-bar-now-playing"+(n?" youtube-player-maximized":""),children:[(0,f.jsxs)("div",{className:`artwork-container player-bar-artwork-container${c}`,children:[(0,f.jsx)("img",{src:s,className:"artwork",alt:""}),o?m():null]}),o?(0,f.jsxs)("div",{className:"track-info",children:[(0,f.jsxs)("div",{className:"track-title-container",children:[(0,f.jsx)("div",{className:"track-info-item track-title multiline",onClick:function(){a===(0,d.uo)()?(0,d.Kr)(a):i(`/playlist/${a}`),e&&t()},children:o.title}),"youtube"===o.player?(0,f.jsx)("a",{href:`https://youtube.com/watch?v=${o.id}`,className:"track-link",target:"_blank",rel:"noreferrer",title:"Open on YouTube",children:(0,f.jsx)(u.A,{id:"link",className:"track-link-icon"})}):null]}),o.artist?(0,f.jsx)("div",{className:"track-info-item",children:o.artist}):null]}):null]})};var w=n(806),g=n(56),k=n(855);const x=function({inert:e,element:t,className:n,progress:i,min:r,now:a,max:o,nowText:s,label:l,labelText:c,pointerDownHandler:d,keyDownHandler:u}){return e?(0,f.jsx)("div",{className:"slider-bar-container",children:(0,f.jsx)("div",{className:"slider-bar",children:(0,f.jsx)("div",{className:"slider-bar-inner"})})}):(0,f.jsxs)("div",{className:"slider-bar-container"+(n?` ${n}`:""),children:[(0,f.jsx)("div",{className:"slider-bar",ref:t,onPointerDown:d,onKeyDown:u,role:"slider",tabIndex:"0","aria-label":c,"aria-valuemin":r,"aria-valuenow":a,"aria-valuemax":o,"aria-valuetext":s,children:(0,f.jsxs)("div",{className:"slider-bar-inner",style:{"--progress":i},children:[(0,f.jsx)("div",{className:"slider-bar-elapsed"}),(0,f.jsx)("div",{className:"slider-bar-thumb"})]})}),l?(0,f.jsx)("div",{className:"slider-label",style:{"--progress":l.progress},children:l.text}):null]})};const T=function({showIndicator:e}){const{activeTrack:t}=(0,l.F)(),[n,i]=(0,c.useState)(!1),[{formattedCurrentTime:r,currentTime:a,progress:o},s]=(0,c.useState)(()=>({currentTime:0,formattedCurrentTime:"0:00",progress:0})),[d,u]=(0,c.useState)(()=>({text:"0:00",progress:0})),m=(0,c.useRef)(!1),p=(0,c.useRef)(null),y=(0,c.useRef)(!0);function b(e){const{target:t,key:n}=e;t instanceof HTMLInputElement&&"text"===t.type||!e.shiftKey||"ArrowRight"!==n&&"ArrowLeft"!==n||h(n)}function h(n){const i=t.durationInSeconds;let r=a;"ArrowRight"===n||"ArrowUp"===n?(r+=5,r>i&&(r=i),e({iconId:"fast-forward"})):"ArrowLeft"!==n&&"ArrowDown"!==n||(r-=5,r<0&&(r=0),e({iconId:"rewind"})),s({currentTime:r,formattedCurrentTime:(0,w.fU)(r),progress:r/t.durationInSeconds*100}),(0,v.wV)(r)}function T({detail:e}){s({currentTime:e,formattedCurrentTime:(0,w.fU)(e),progress:e/t.durationInSeconds*100}),navigator.mediaSession.setPositionState({duration:t.durationInSeconds,position:e}),(0,k.MU)()||g.FZ({currentTime:e})}function j({pageX:e}){m.current||(m.current=!0,requestAnimationFrame(()=>{const{left:n,width:i}=p.current.getBoundingClientRect();let a=(e-n)/i;a<0?a=0:a>1&&(a=1);const o=Math.round(t.durationInSeconds*a),l=100*a;s({currentTime:o,formattedCurrentTime:r,progress:l}),u({text:(0,w.fU)(o),progress:l}),m.current=!1}))}function L({currentTarget:e,pageX:n}){m.current||(m.current=!0,requestAnimationFrame(()=>{const{left:i,width:r}=e.getBoundingClientRect();let a=(n-i)/r;a<0?a=0:a>1&&(a=1);const o=Math.round(t.durationInSeconds*a);u({text:(0,w.fU)(o),progress:100*a}),m.current=!1}))}function E(){m.current=!0,requestAnimationFrame(()=>{u(null),m.current=!1})}function I(){s({currentTime:a,formattedCurrentTime:(0,w.fU)(a),progress:o}),i(!1),(0,v.wV)(a)}return(0,c.useEffect)(()=>{if(t){if(y.current){y.current=!1;const e=g.UE();e&&s({currentTime:e.currentTime,formattedCurrentTime:(0,w.fU)(e.currentTime),progress:e.currentTime/t.durationInSeconds*100})}return()=>{s({currentTime:0,formattedCurrentTime:"0:00",progress:0})}}},[t]),(0,c.useEffect)(()=>(t&&window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}),[a,t]),(0,c.useEffect)(()=>(t&&(window.addEventListener("current-time-update",T),n?(window.addEventListener("pointermove",j),p.current.removeEventListener("pointermove",L),p.current.removeEventListener("pointerleave",E),window.removeEventListener("current-time-update",T)):(p.current.addEventListener("pointermove",L),p.current.addEventListener("pointerleave",E))),()=>{p.current&&(p.current.removeEventListener("pointermove",L),p.current.removeEventListener("pointerleave",E)),window.removeEventListener("pointermove",j),window.removeEventListener("current-time-update",T)}),[n,t]),(0,c.useEffect)(()=>(n&&window.addEventListener("pointerup",I),()=>{window.removeEventListener("pointerup",I)}),[a,n]),t?(0,f.jsxs)("div",{className:"seek-slider-container",children:[(0,f.jsx)("div",{className:"seek-slider-time",style:{width:`${t.duration.length}ch`,textAlign:"right"},children:r}),(0,f.jsx)(x,{element:p,progress:o,label:d,pointerDownHandler:function(e){t&&0===e.button&&(i(!0),j(e))},keyDownHandler:function({shiftKey:e,key:t}){!e&&t.startsWith("Arrow")&&h(t)},min:"0",now:a,max:t.durationInSeconds,nowText:`${r} / ${t.duration}`,labelText:"Seek slider"},t.id),(0,f.jsx)("div",{className:"seek-slider-time",children:t.duration})]}):(0,f.jsxs)("div",{className:"seek-slider-container",children:[(0,f.jsx)("div",{className:"seek-slider-time",children:"0:00"}),(0,f.jsx)(x,{inert:!0}),(0,f.jsx)("div",{className:"seek-slider-time",children:"0:00"})]})};const j=function({visible:e,showIndicator:t}){const[n,i]=(0,c.useState)(()=>(0,p.PL)("mute")),[r,a]=(0,c.useState)(()=>(0,p.PL)("volume")),[o,s]=(0,c.useState)(!1),l=(0,c.useRef)(!1),d=(0,c.useRef)(null);function m(e){const t=e.ctrlKey||e.shiftKey||e.altKey||e.metaKey,{target:i,key:r}=e;i instanceof HTMLInputElement&&"text"===i.type||(!e.shiftKey||"ArrowUp"!==r&&"ArrowDown"!==r?t||"m"!==r||b(!n,!0):h(r))}function y(e){(0,p.ZC)("volume",e),a(e),v.ls(e)}function b(e,n=!1){let r=0;i(e),(0,p.ZC)("mute",e),e?(n&&t({iconId:"volume-off",text:"0%"}),(0,p.ZC)("volume-before-mute",(0,p.PL)("volume"))):(r=(0,p.PL)("volume-before-mute"),n&&t({iconId:"volume",text:`${Math.round(100*r)}%`}),(0,p.dH)("volume-before-mute")),y(r)}function h(e){let n=r;if(n<1&&"ArrowRight"===e||"ArrowUp"===e)n||(i(!1),(0,p.ZC)("mute",!1),(0,p.dH)("volume-before-mute")),n+=.05,n>1&&(n=1);else if((n||"ArrowDown"===e)&&(n-=.05,parseFloat(n.toFixed(2))<=0))return void b(!0,!0);y(n),t({iconId:"volume",text:`${Math.round(100*n)}%`})}function w({pageX:e}){l.current||(l.current=!0,requestAnimationFrame(()=>{const{left:t,width:i}=d.current.getBoundingClientRect();let r=(e-t)/i;r<=0?(r=0,n||b(!0)):n?b(!1):(r>1&&(r=1),y(r)),l.current=!1}))}function g(){s(!1)}return(0,c.useEffect)(()=>(window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}),[n,r]),(0,c.useEffect)(()=>(o&&(window.addEventListener("pointermove",w),window.addEventListener("pointerup",g)),()=>{window.removeEventListener("pointermove",w),window.removeEventListener("pointerup",g)}),[n,o]),(0,f.jsxs)("div",{className:"player-bar-volume-controls"+(e?" visible":""),children:[(0,f.jsx)("button",{className:"btn icon-btn player-bar-tertiary-btn"+(n?" active":""),onClick:function(){b(!n)},title:n?"Unmute":"Mute",children:(0,f.jsx)(u.A,{id:n?"volume-off":"volume",className:"player-bar-tertiary-btn-icon"})}),(0,f.jsx)(x,{element:d,className:"player-bar-volume-bar-container",progress:100*r,pointerDownHandler:function(e){0===e.button&&(s(!0),w(e))},keyDownHandler:function({shiftKey:e,key:t}){!e&&t.startsWith("Arrow")&&h(t)},min:"0",now:r,max:"1",nowText:`${Math.round(100*r)}%`,labelText:"Volume slider"})]})};const L=function({nowPlayingVisible:e,queueVisible:t,youtubePlayer:n,toggleNowPlaying:i,toggleQueue:r,toggleYoutubePlayer:a,showIndicator:o}){const{paused:s,activePlaylistId:m,activeTrack:b,trackLoading:g,togglePlay:k,playPrevious:x,playNext:L,playPlaylist:E}=(0,l.F)(),[I,N]=(0,c.useState)(()=>(0,p.PL)("shuffle")),[S,P]=(0,c.useState)(()=>z((0,p.PL)("repeat"))),[$,A]=(0,c.useState)(!1),[M,C]=(0,c.useState)(null),[O,R]=(0,c.useState)(!1),H=(0,c.useRef)(0);function q(e){const{target:t,key:n}=e;if(t instanceof HTMLInputElement&&"text"===t.type)return;e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||("p"===n?B(!0):"r"===n?F():"s"===n?V():"["===n?m&&(L(),o({iconId:"next"})):"o"===n&&m&&(x(),o({iconId:"previous"})))}function B(e=!1){if(m)return k(),void(e&&o({iconId:s?"play":"pause"}));const t=(0,d.uo)();E(t,{scrollToTrack:!0})}function U(e){C(e),clearTimeout(H.current),H.current=setTimeout(()=>{C(null)},1e3)}function V(){N(!I),(0,p.ZC)("shuffle",!I),v.Gx(m,v.gc()),U({type:"shuffle",text:I?"No shuffle":"Shuffle"}),(0,w.w3)("shuffle",!I)}function z(e){return{"repeat-off":{title:"Repeat",iconId:"repeat"},"repeat-all":{title:"Repeat one",iconId:"repeat",active:!0},"repeat-one":{title:"No repeat",iconId:"repeat-one",active:!0}}[e]}function F(){const e=(0,p.PL)("repeat"),t={"repeat-off":"repeat-all","repeat-all":"repeat-one","repeat-one":"repeat-off"}[e],n=z(t),i=z(e);P(n),(0,p.ZC)("repeat",t),U({type:"repeat",text:i.title})}function D(){R(!1)}return(0,c.useEffect)(()=>(window.addEventListener("pip-close",D),()=>{window.removeEventListener("pip-close",D)}),[]),(0,c.useEffect)(()=>(window.addEventListener("keydown",q),()=>{window.removeEventListener("keydown",q)}),[s,m,I]),(0,f.jsxs)("div",{className:`player-bar${e?" transparent":""}${"maximized"===n.mode?" youtube-player-maximized":""}${t?" queue-visible":""}`,children:[(0,f.jsx)(h,{visible:e,toggleNowPlaying:i,youtubePlayerMaximized:"maximized"===n.mode}),(0,f.jsx)(T,{showIndicator:o}),(0,f.jsxs)("div",{className:"player-bar-middle",children:[(0,f.jsxs)("div",{className:"player-bar-shuffle-container",children:["shuffle"===M?.type&&(0,f.jsx)("div",{className:"player-bar-setting-label",children:M.text}),(0,f.jsx)("button",{className:"btn icon-btn player-bar-tertiary-btn"+(I?" active":""),onClick:V,"aria-label":I?"No shuffle":"Shuffle",children:(0,f.jsx)(u.A,{id:"shuffle",className:"player-bar-tertiary-btn-icon"})})]}),(0,f.jsx)("button",{className:"btn icon-btn player-bar-secondary-btn",onClick:x,"aria-label":"Previous",children:(0,f.jsx)(u.A,{id:"previous",className:"player-bar-secondary-btn-icon"})}),(0,f.jsxs)("button",{className:"btn icon-btn player-bar-play-pause-btn",onClick:()=>B(),"aria-label":s?"Play":"Pause",children:[(0,f.jsx)(u.A,{id:s?"play-circle":"pause-circle",className:"player-bar-play-pause-btn-icon"}),g&&(0,f.jsx)(u.A,{id:"spinner",className:"play-pause-btn-spinner"})]}),(0,f.jsx)("button",{className:"btn icon-btn player-bar-secondary-btn",onClick:L,"aria-label":"Next",children:(0,f.jsx)(u.A,{id:"next",className:"player-bar-secondary-btn-icon"})}),(0,f.jsxs)("div",{className:"player-bar-repeat-container",children:["repeat"===M?.type&&(0,f.jsx)("div",{className:"player-bar-setting-label",children:M.text}),(0,f.jsx)("button",{className:"btn icon-btn player-bar-tertiary-btn"+(S.active?" active":""),onClick:F,"aria-label":S.title,children:(0,f.jsx)(u.A,{id:S.iconId,className:"player-bar-tertiary-btn-icon"})})]})]}),(0,f.jsxs)("div",{className:"player-bar-right-controls"+($?" visible":""),children:[e&&"youtube"===b?.player?(0,f.jsx)("button",{className:"btn icon-btn player-bar-tertiary-btn"+("off"!==n.mode?" active":""),onClick:a,title:n.title,children:(0,f.jsx)(u.A,{id:n.iconId,className:"player-bar-tertiary-btn-icon"})}):null,b?(0,f.jsx)("button",{className:"btn icon-btn player-bar-tertiary-btn"+(t?" active":""),onClick:r,title:"Queue",children:(0,f.jsx)(u.A,{id:"queue",className:"player-bar-tertiary-btn-icon"})}):null,b&&y.TT()?(0,f.jsx)("button",{className:"btn icon-btn player-bar-tertiary-btn"+(O?" active":""),onClick:function(){R(!O),y.L$({paused:s,track:b,togglePlay:k,playNext:L,playPrevious:x})},title:"Toggle picture-in-picture",children:(0,f.jsx)(u.A,{id:"pip",className:"player-bar-tertiary-btn-icon"})}):null,(0,f.jsx)(j,{visible:$,showIndicator:o})]}),(0,f.jsx)("button",{className:"btn icon-btn player-bar-tertiary-btn player-bar-volume-toggle-btn"+($?" active":""),onClick:function(){A(!$)},title:"Volume",children:(0,f.jsx)(u.A,{id:"volume",className:"player-bar-tertiary-btn-icon"})})]})},E=(0,c.lazy)(()=>n.e(695).then(n.bind(n,695))),I=(0,c.lazy)(()=>n.e(381).then(n.bind(n,381))),N=(0,c.lazy)(()=>n.e(626).then(n.bind(n,626))),S=(0,c.lazy)(()=>n.e(746).then(n.bind(n,746))),P=(0,c.lazy)(()=>n.e(957).then(n.bind(n,957))),$=(0,c.lazy)(()=>n.e(79).then(n.bind(n,79))),A=(0,c.lazy)(()=>n.e(144).then(n.bind(n,144))),M=(0,c.lazy)(()=>n.e(627).then(n.bind(n,627)));function C(){const{notifications:e}=(0,a.h)(),{initialized:t,activeTrack:n}=(0,l.F)(),i=(0,r.zy)(),o=(0,r.Zp)(),[s,u]=(0,c.useState)(!1),[p,v]=(0,c.useState)(()=>O(localStorage.getItem("youtube-player")||"off")),[y,b]=(0,c.useState)(null),h=(0,c.useRef)(0),w=(0,c.useRef)("/"),g=i.pathname.startsWith("/now-playing");function k({key:e}){"Escape"===e&&T()}function x(){const e=document.activeElement;e instanceof HTMLIFrameElement&&requestAnimationFrame(()=>{e.blur()})}function T(){g?(o(w.current),w.current=""):((0,d.j6)(),o("/now-playing"),w.current=i.pathname)}function j(){u(!s)}function C(e){e&&b(null),requestAnimationFrame(()=>{b(e),clearTimeout(h.current),h.current=setTimeout(()=>{b(null)},1e3)})}function O(e){return{off:{mode:"off",title:"Show YouTube player",iconId:"mini"},mini:{mode:"mini",title:"Maximize YouTube player",iconId:"maximized",active:!0},maximized:{mode:"maximized",title:"Hide YouTube player",iconId:"off",active:!0}}[e]}return(0,c.useLayoutEffect)(()=>{if(t)return g&&(n?window.addEventListener("keydown",k):o("/",{replace:!0})),()=>{window.removeEventListener("keydown",k)}},[t,n,i.pathname]),(0,c.useLayoutEffect)(()=>{n?"native"!==n.player||"off"===p.mode||p.stateBefore?"youtube"===n.player&&p.stateBefore&&v({...p.stateBefore}):v({stateBefore:p}):s&&u(!1)},[n]),(0,c.useEffect)(()=>{if("off"!==p.mode)return window.addEventListener("blur",x),()=>{window.removeEventListener("blur",x)}},[p]),(0,f.jsxs)(f.Fragment,{children:[g?null:(0,f.jsx)(m,{}),(0,f.jsx)("div",{className:"content",children:(0,f.jsx)(c.Suspense,{fallback:null,children:(0,f.jsxs)(r.BV,{children:[(0,f.jsx)(r.qh,{path:"/",element:(0,f.jsx)(E,{})}),(0,f.jsx)(r.qh,{path:"/search",element:(0,f.jsx)(I,{})}),(0,f.jsx)(r.qh,{path:"/playlist/:id",element:(0,f.jsx)(N,{})}),(0,f.jsx)(r.qh,{path:"/now-playing",element:n?(0,f.jsx)(S,{queueVisible:s,youtubePlayerMode:p.mode,showIndicator:C}):null}),(0,f.jsx)(r.qh,{path:"*",element:(0,f.jsx)(M,{})})]})})}),(0,f.jsx)(L,{nowPlayingVisible:g,queueVisible:s,youtubePlayer:p,toggleNowPlaying:T,toggleQueue:j,toggleYoutubePlayer:function(){const e={off:"mini",mini:"maximized",maximized:"off"}[p.mode];v(O(e)),localStorage.setItem("youtube-player",e)},showIndicator:C}),s&&n&&(0,f.jsx)(c.Suspense,{fallback:null,children:(0,f.jsx)(P,{toggleQueue:j,nowPlayingVisible:g,youtubePlayerMaximized:"maximized"===p.mode})}),e.length>0&&(0,f.jsx)(c.Suspense,{fallback:null,children:(0,f.jsx)($,{notifications:e})}),function(){let e="";return g&&("mini"===p.mode?e=" visible":"maximized"===p.mode&&(e=" visible maximized")),(0,f.jsx)("div",{id:"js-youtube-player-container",className:`youtube-player-container${e}${s?" shift":""}`})}(),y&&(0,f.jsx)(c.Suspense,{fallback:null,children:(0,f.jsx)(A,{indicator:y,nowPlayingVisible:g,queueVisible:s,youtubePlayerMaximized:"maximized"===p.mode})})]})}function O(){return(0,f.jsx)(r.I9,{children:(0,f.jsx)(a.p,{children:(0,f.jsx)(o.m,{children:(0,f.jsx)(s.z,{children:(0,f.jsx)(l.J,{children:(0,f.jsx)(C,{})})})})})})}(0,i.createRoot)(document.getElementById("root")).render((0,f.jsx)(O,{})),navigator.serviceWorker.register("./sw.js").catch(console.log)},367:(e,t,n)=>{n.d(t,{RM:()=>d,_D:()=>s,updateTrackWithMetadata:()=>c,vf:()=>v});var i=n(806),r=n(244);let a=null,o=null;function s(e,t){return e.reduce((e,n)=>{if(!n.type.startsWith("audio"))return e;const r=(a=n.name.trim()).slice(0,a.lastIndexOf("."));var a;return t.some(e=>e.name===r)||e.push({needsMetadata:!0,id:(0,i.$f)(),date:n.lastModified,audioTrack:n,name:r,title:r,artist:"",album:"",durationInSeconds:0,duration:"",player:"native"}),e},[])}function l(e,t){return new Promise(s=>{const l={workerType:t,checkLastFm:"true"===localStorage.getItem("use-last.fm")};let c=null;"one"===t?(a||(a=new Worker(new URL(n.p+n.u(744),n.b),{type:void 0})),c=a):"many"===t&&(o||(o=new Worker(new URL(n.p+n.u(363),n.b),{type:void 0})),c=o),c.addEventListener("message",function(e){return function t({target:n,data:s}){const{type:l,track:c,artwork:d,workerType:u,done:f=!1}=s;"track"===l?((0,i.w3)("track",{track:c,done:f}),d&&(0,r.pq)(c.artworkId,d),f&&(n.removeEventListener("message",t),n.terminate(),e(c),"one"===u?a=null:"many"===u&&(o=null))):"image"===l&&function(e,{hash:t,file:n},a){const o=new Image,s=document.createElement("canvas"),l=s.getContext("2d");o.crossOrigin="anonymous",o.onload=function(){let{width:c,height:d}=o;const u=Math.min(c,d,256);c<d?(d=u/o.width*d,c=u):(c=u/o.height*c,d=u),s.width=c,s.height=d,l.drawImage(o,0,0,c,d),s.toBlob(o=>{(0,r.pq)(t,{original:{blob:n},small:{blob:o},type:n.type}),(0,i.w3)("track",{track:e,done:a})},n.type,.72),URL.revokeObjectURL(o.src)},o.src=URL.createObjectURL(n)}(c,s.image,f)}}(s)),c.postMessage({payload:e,...l})})}function c(e){return l(e,"one")}function d(e){return l(e,"many")}function u(e){return new Promise(t=>{const n=e.createReader();let i=[];!function e(){n.readEntries(async n=>{if(n.length>0){for(const e of n)if(e.isFile){const t=await f(e);t.type.startsWith("audio")&&i.push(t)}else if(e.isDirectory){const t=await u(e);i=i.concat(t)}e()}else t(i)})}()})}function f(e){return new Promise(t=>{e.file(t)})}window.addEventListener("drop",async e=>{if(e.preventDefault(),e.dataTransfer.items.length){const t=await async function(e){const t=[],n=[];for(const i of e)if("file"===i.kind&&(""===i.type||i.type.startsWith("audio"))){const e=i.webkitGetAsEntry();e.isDirectory?n.push(u(e)):e.isFile&&t.push(f(e))}const i=await Promise.all([...n,...t]);let r=[];for(const e of i)Array.isArray(e)?r=r.concat(e):r.push(e);return r}(e.dataTransfer.items);t.length&&(0,i.w3)("file-handler",t)}}),window.addEventListener("dragover",e=>{e.preventDefault()});let m=[],p=!0;function v(){return m}document.addEventListener("paste",async e=>{const t=await navigator.clipboard.read(),n=[];e.preventDefault();for(const e of t){const t=e.types?.filter(e=>e.startsWith("audio/"));for(const i of t){const t=await e.getType(i);n.push(t)}}n.length&&(0,i.w3)("file-handler",n)}),"launchQueue"in window&&"files"in window.LaunchParams.prototype&&window.launchQueue.setConsumer(async e=>{if(!e.files.length)return;const t=[];for(const n of e.files){const e=await n.getFile();t.push(e)}t.length&&(p?(p=!1,m=[...t]):m.length=0,(0,i.w3)("file-handler",t))})},400:(e,t,n)=>{n.d(t,{$n:()=>C,Bx:()=>I,Eg:()=>M,GV:()=>H,Kr:()=>V,OM:()=>q,ON:()=>x,WM:()=>E,be:()=>N,cb:()=>R,gB:()=>L,j6:()=>y,kT:()=>b,lK:()=>P,sW:()=>h,uo:()=>m});var i=n(568),r=n(955),a=n(440),o=n(244);let s=null,l=null,c="",d="",u=null,f=0;function m(){return c}function p(e){e.forEach(({isIntersecting:e,target:t})=>{const{id:n,tracks:r,viewMode:a}=(0,i.LR)(c),s=r[Number(t.getAttribute("data-index"))];s&&(t.innerHTML=e?function(e,t,n){if(e.title=e.title.replace(/<(.+?)>/g,(e,t)=>`&lt;${t}&gt;`),"grid"===n)return function(e,t){const{title:n,id:i}=U(e.index,t);return`\n    <div class="artwork-container grid-item-thumbnail">\n      <img src="${(0,o.TT)(e.artworkId).small.url}" class="artwork" alt="">\n      <button class="btn icon-btn artwork-btn" title="${n}">\n        ${h({iconId:i,className:"artwork-btn-icon"})}\n      </button>\n    </div>\n    ${function(e){return`\n    <div class="track-info">\n      <div class="track-info-item track-title multiline">${e.title}</div>\n      ${e.artist?`<div class="track-info-item">${e.artist}</div>`:""}\n      <div class="track-info-item-duration">${e.duration}</div>\n    </div>\n  `}(e)}\n  `}(e,t);if("compact"===n)return function(e,t){const{title:n,id:r}=U(e.index,t),{sortOrder:a}=(0,i.qX)(t),s=a.indexOf(e.index);return`\n    <div class="track-first-col">\n      <div class="track-index">${s+1}</div>\n      <button class="btn icon-btn artwork-btn" title="${n}">\n        ${h({iconId:r,className:"artwork-btn-icon"})}\n      </button>\n    </div>\n    <div class="artwork-container compact-item-thumbnail">\n      <img src="${(0,o.TT)(e.artworkId).small.url}" class="artwork" alt="">\n    </div>\n    ${function(e){return`\n    <div class="track-info">\n      <div class="track-info-item track-title${e.artist?"":" multiline"}">${e.title}</div>\n      ${e.artist?`<div class="track-info-item">${e.artist}</div>`:""}\n    </div>\n  `}(e)}\n    <div class="track-col">${e.album}</div>\n    <div class="track-last-col">${e.duration}</div>\n  `}(e,t);return function(e,t){const{sortOrder:n}=(0,i.qX)(t),r=n.indexOf(e.index),{title:a,id:o}=U(e.index,t);return`\n    <div class="track-first-col">\n      <div class="track-index">${r+1}</div>\n      <button class="btn icon-btn artwork-btn" title="${a}">\n        ${h({iconId:o,className:"artwork-btn-icon"})}\n      </button>\n    </div>\n    <div class="track-col">${e.title}</div>\n    <div class="track-col">${e.artist}</div>\n    <div class="track-col">${e.album}</div>\n    <div class="track-last-col">${e.duration}</div>\n  `}(e,t)}(structuredClone(s),n,a):k(s,a))})}function v(e){l&&l.disconnect(),l=new IntersectionObserver(p,{root:e,rootMargin:"200px 0px"});const{children:t}=e.lastElementChild;Array.from(t).forEach(e=>{l.observe(e)})}function y(){s&&(f=s.scrollTop)}function b(){l&&(l.disconnect(),l=null),c="",d="",s=null,(0,r.I$)(),window.removeEventListener("track",T),window.removeEventListener("tracks",j)}function h(e){return`\n    <svg viewBox="0 0 24 24"${e.elementId?` id=${e.elementId}`:""}${e.className?` class="${e.className}"`:""}>\n      ${e.title?`<title>${e.title}</title>`:""}\n      <use href="#${e.iconId}"></use>\n    </svg>\n  `}function w(e){const{id:t,tracks:n}=e,{sortOrder:r}=(0,i.qX)(t);let a="";for(const t of r){a+=g(n[t],e)}return a}function g(e,{id:t,viewMode:n}){const i=k(e,n);let r="";if(d){const t=new RegExp(`(${d})`,"i"),n=t.test(e.title)||t.test(e.artist)||t.test(e.album);console.log(e),n||(r+=" hidden")}if(u){let n=t,i=e.index;"search"===t&&(n=e.playlistId,i=e.playlistIndex),u.playlistId===n&&u.index===i&&(r+=" playing")}return`<li class="track ${n}-item${r}" data-index="${e.index}">${i}</li>`}function k(e,t){return"grid"===t?'\n    <div class="artwork-container grid-item-thumbnail placeholder"></div>\n    <div class="grid-item-info-placeholder">\n      <div class="grid-item-title-placeholder"></div>\n      <div class="grid-item-artist-placeholder"></div>\n      <div class="grid-item-duration-placeholder"></div>\n    </div>\n  ':"compact"===t?function(e){return`\n    <div class="track-first-col">\n      <div class="track-index-placeholder"></div>\n    </div>\n    <div class="artwork-container compact-item-thumbnail"></div>\n    <div class="track-col">\n      <div class="compact-item-title-placeholder"></div>\n      <div class="compact-item-artist-placeholder"></div>\n    </div>\n    <div class="track-col">\n      ${e.album?'<div class="track-col-inner"></div>':""}\n    </div>\n    <div class="track-last-col">\n      <div class="track-duration-placeholder"></div>\n    </div>\n  `}(e):function(e){return`\n    <div class="track-first-col">\n      <div class="track-index-placeholder"></div>\n    </div>\n    <div class="track-col">\n      <div class="track-col-inner"></div>\n    </div>\n    <div class="track-col">\n      ${e.artist?'<div class="track-col-inner"></div>':""}\n    </div>\n    <div class="track-col">\n      ${e.album?'<div class="track-col-inner"></div>':""}\n    </div>\n    <div class="track-last-col">\n      <div class="track-duration-placeholder"></div>\n    </div>\n  `}(e)}function x(e,t){const n=w(t);s=e,c=t.id,"grid"===t.viewMode?e.innerHTML=`<ul id="js-${t.id}" class="playlist-items grid-items">${n}</ul>`:"compact"===t.viewMode?e.innerHTML=function(e,t){return`\n  <ul class="playlist-view-header">\n    <li class="track-first-col">#</li>\n    <li class="compact-item-second-col">TITLE</li>\n    <li class="track-col">ALBUM</li>\n    <li class="track-last-col">DURATION</li>\n  </ul>\n  <ul id="js-${e}" class="playlist-items compact-items">${t}</ul>\n  `}(t.id,n):"minimal"===t.viewMode&&(e.innerHTML=function(e,t){return`\n    <ul class="playlist-view-header">\n      <li class="track-first-col">#</li>\n      <li class="track-col">TITLE</li>\n      <li class="track-col">ARTIST</li>\n      <li class="track-col">ALBUM</li>\n      <li class="track-last-col">DURATION</li>\n    </ul>\n    <ul id="js-${e}" class="playlist-items minimal-items">${t}</ul>\n  `}(t.id,n)),v(e),"local-files"===t.id&&window.addEventListener("track",T),"search"!==t.id&&window.addEventListener("tracks",j),(0,r.Hb)(e,t.viewMode)}function T({detail:{track:e}}){!function(e){const{children:t}=l.root.lastElementChild,{sortOrder:n}=(0,i.qX)("local-files"),r=t[n.indexOf(e.index)];r&&(l.unobserve(r),l.observe(r))}(e)}function j({detail:{id:e,tracks:t,type:n}}){e===c&&("replace"===n?function(e,t){const n=(0,i.LR)(t);e.lastElementChild.innerHTML=w(n),v(e)}(s,e):function(e,t,n){const r=(0,i.LR)(n),a=e.reduce((e,t)=>e+g(t,r),"");t.lastElementChild.insertAdjacentHTML("beforeend",a),v(t)}(t,s,e))}function L(e){d=e}function E(){return d}function I(e){const{tracks:t,id:n}=(0,i.LR)(c);if(e){if(!t.length)return;const{children:r}=document.getElementById(`js-${n}`),{sortOrder:a}=(0,i.qX)(n),o=new RegExp(`(${e})`,"i");let s=!1;for(const e of t){const t=o.test(e.title)||o.test(e.artist)||o.test(e.album);t&&(s=!0),r[a.indexOf(e.index)].classList.toggle("hidden",!t)}return s}return N(n),!0}function N(e){const t=document.getElementById(`js-${e}`).querySelectorAll(".hidden");for(const e of t)e.classList.remove("hidden")}function S(e,t){if(t===c){const{sortOrder:n}=(0,i.qX)(t),r=n.indexOf(e);return document.getElementById(`js-${t}`).children[r]}}function P(e,t,n){if(e>=0){const i=S(e,t);if(u={index:e,playlistId:t},i)i.classList.add("playing"),n&&V(t);else{const e=O();e&&e.classList.add("playing")}}else u=null}function $(e){if(!e)return;e.querySelector(".play-pause-btn-spinner")||e.insertAdjacentHTML("beforeend",'\n    <svg viewBox="0 0 100 100" class="play-pause-btn-spinner">\n      <use href="#spinner"/>\n    </svg>\n  ')}function A(e){if(!e)return;const t=e.querySelector(".play-pause-btn-spinner");t&&t.remove()}function M(){if(u){const e=S(u.index,u.playlistId);if(e)$(e.querySelector(".icon-btn"));else{const e=O();e&&$(e.querySelector(".icon-btn"))}}}function C(){if(u){const e=S(u.index,u.playlistId);if(e)A(e.querySelector(".icon-btn"));else{const e=O();e&&A(e.querySelector(".icon-btn"))}}}function O(){const e=(0,i.LR)("search");if(!e||!u)return;const t=document.getElementById("js-search");for(const n of t.children){const t=e.tracks[n.getAttribute("data-index")];if(u.index===t.playlistIndex&&u.playlistId===t.playlistId)return n}}function R(){H(!0),C(),u&&function(){const e=S(u.index,u.playlistId);if(e)e.classList.remove("playing");else{const e=O();e&&e.classList.remove("playing")}u=null}()}function H(e){if(!c)return;const t=function(){if(u){const e=S(u.index,u.playlistId);if(e)return e.querySelector(".icon-btn")}}();if(t)B(t,e);else if("search"===c){const t=O();if(t){const n=t.querySelector(".icon-btn");n&&B(n,e)}}}function q(e){return e?{id:"play-circle",title:"Play"}:{id:"pause-circle",title:"Pause"}}function B(e,t){const{id:n,title:i}=q(t);"svg"===e.nodeName?e.querySelector("title").textContent=i:e.setAttribute("title",i),e.querySelector("use").setAttribute("href",`#${n}`)}function U(e,t){const n=(0,a.Qg)();if("search"===t){const r=(0,i.LR)(t).tracks[e];if(r.playlistId!==n)return q(!0);e=r.playlistIndex}else if(t!==n)return q(!0);const r=(0,a.yu)(),o=(0,a.b)();return r&&r.index===e?q(o):q(!0)}function V(e){(0,a.Qg)()===e?u&&s&&(requestAnimationFrame(()=>{const{clientHeight:e,scrollTop:t}=s,{offsetHeight:n,offsetTop:i}=S(u.index,u.playlistId);(i-n<t||i>t+e)&&(s.scrollTop=i-e/2)}),f=0):s&&requestAnimationFrame(()=>{s.scrollTop=f,f=0})}},440:(e,t,n)=>{n.d(t,{v_:()=>fe,Qg:()=>K,yu:()=>_,gB:()=>D,js:()=>pe,jj:()=>ve,gc:()=>Q,Mu:()=>X,b:()=>Z,Wv:()=>me,c6:()=>ne,GT:()=>ae,$N:()=>te,mb:()=>re,V2:()=>ie,Xv:()=>F,_0:()=>se,wV:()=>de,Ay:()=>W,Gx:()=>J,fq:()=>G,ls:()=>ue,Cn:()=>oe,GO:()=>ce,d5:()=>le});var i=n(806),r=n(191),a=n(56),o=n(400),s=n(568),l=n(244),c=n(855);let d,u,f=0;function m(e,t,n){f=n||0,d=URL.createObjectURL(e.audioTrack),u=new Audio(d),u.onplaying=function(){(0,i.w3)("player-state",{loading:!1})},u.ontimeupdate=function(){u.currentTime-f>=1&&(f>=e.durationInSeconds?(0,i.w3)("track-end"):(f=Math.round(u.currentTime),(0,i.w3)("current-time-update",f)))},u.onended=function(){(0,i.w3)("track-end")},u.onerror=function(t){const{id:n}=pe(1,"local-files");if(e.id===n)ce();else{const e=(0,r.PL)("repeat");(0,i.w3)("player-state",{loading:!1}),(0,i.w3)("track-end","repeat-one"===e)}(0,i.w3)("notification",{value:`Cannot play ${e.name}.\nIts location might have changed.`}),console.log(t)},p(t),"number"!=typeof n?u.play():v(n)}function p(e){u.volume=e}function v(e){u.currentTime=e,f=e}const y=0,b=1,h=2,w=3;let g=null,k=null,x=!1,T=!1,j=!1,L=0,E=0,I=null;function N({data:e}){let t=null;clearTimeout(L),e===w?t={loading:!0}:e===b?(T=!1,t={loading:!1,paused:!1},$(performance.now(),Math.round(g.getCurrentTime()))):e===h?t={loading:!1,paused:!0}:e===y&&(0,i.w3)("track-end"),t&&(0,i.w3)("player-state",t)}function S(){const{track:e,volume:t,startTime:n}=k,i=E||n;E=0,x=!0,R(t),i>=0?j?(k=null,g.loadVideoById(e.id,i)):(T=!0,g.cueVideoById(e.id,i)):C(e,t)}function P(e){let t="";if(100===e.data?t="Video is either removed or marked as private":101!==e.data&&150!==e.data||(t="The owner of the requested video does not allow it to be played in embedded players"),console.log(e),t){const e=K(),{id:n}=pe(1,e);I.id===n?ce():(0,i.w3)("track-end"),(0,i.w3)("notification",{value:t})}}function $(e,t,n=0){const r=performance.now()-e;L=setTimeout(()=>{t<I.durationInSeconds&&(t+=1,(0,i.w3)("current-time-update",t)),$(e,t,n+1e3)},1e3-(r-n))}function A(){g=new YT.Player("js-youtube-player",{playerVars:{autoplay:0,modestbranding:1,disablekb:1,controls:0,fs:0,rel:0,iv_load_policy:3},events:{onReady:S,onStateChange:N,onError:P}})}function M(e){x?(T=!1,e?g.playVideo():g.pauseVideo()):j=e}function C(e,t,n){I=e,x?g.loadVideoById(e.id,n):(document.getElementById("js-youtube-player-container").insertAdjacentHTML("beforeend",'\n    <div id="js-youtube-player" class="youtube-player"></div>\n  '),k={track:e,volume:t,startTime:n},window.onYouTubeIframeAPIReady=A,i.Zc.load({src:"https://www.youtube.com/iframe_api"}))}function O(){x&&(T=!1,k=null,I=null,g.stopVideo(),clearTimeout(L))}function R(e){x&&g.setVolume(100*e)}let H="",q=null,B=!0,U=[],V=-1;const z=[];function F(e){z.push(e)}function D(){return z}function W(e){H=e}function K(){return H}function _(){return q}function Q(){return V}function Y(e){V=U.indexOf(e),V=V<0?-1:V}function Z(){return B}function G(e){B=e,navigator.mediaSession.playbackState=B?"paused":"playing"}function X(){return U}function J(e,t=-1){if(!e)return;const n=(0,r.PL)("shuffle"),{tracks:a}=(0,s.LR)(e);if(n){const e=a.map(({index:e})=>e);U=(0,i.R3)(e),t>=0&&function(e){for(let t=0;t<U.length;t++)if(U[t]===e){[U[0],U[t]]=[e,U[0]];break}}(t)}else U=(0,s.qX)(e).sortOrder;z.length=0,function(e,t){if(q&&t===H){const t=e.find(({id:e})=>e===q.id),n=t?t.index:-1;q.index=n,Y(n)}}(a,e)}function ee(){(0,i.w3)("current-time-update",0),(0,o.cb)(),function(e){"native"===e?(u.pause(),u.ontimeupdate=null,u.onended=null,u.onplaying=null,u.onerror=null,u.currentTime=0,u=null,d&&(URL.revokeObjectURL(d),d=null)):"youtube"===e&&O()}(q.player)}function te(e,{scrollToTrack:t}={}){q&&ee(),J(e);const n=ve(0,e);n?oe(n,e,{scrollToTrack:t}):ce()}function ne(e,t){q&&ee();(0,c.MU)()&&(0,c.U4)(null),J(t,e);oe((0,s.LR)(t).tracks[e],t)}function ie(e,t){if(q){(0,c.MU)()||(0,c.U4)({playlistId:H,playbackIndex:V,track:q}),ee()}oe(e,t,{scrollToTrack:!0})}function re({scrollToTrack:e}={}){q&&ee();const t=(0,c.MU)();if(t){const{track:n,playlistId:i}=t;return oe(n,i,{scrollToTrack:e}),void(0,c.U4)(null)}const n=pe(-1,H);n&&oe(n,H,{scrollToTrack:!0})}function ae(e,{scrollToTrack:t}={}){const n=(0,c.MU)();if(q&&(!n&&e&&(0,c.U4)({playlistId:H,playbackIndex:V,track:q}),ee()),e){const{track:i,playlistId:r}=e;return void oe(i,r,{queueStart:n,scrollToTrack:t})}n&&(H=n.playlistId,V=n.playbackIndex,(0,c.U4)(null));const i=pe(1,H);i?oe(i,H,{scrollToTrack:t}):ce()}async function oe(e,t,{queueStart:s,currentTime:c,scrollToTrack:d,willPlay:u=!0}={}){if(e.needsMetadata){(0,i.w3)("player-state",{loading:!0});const{updateTrackWithMetadata:t}=await Promise.resolve().then(n.bind(n,367));e=await t(e),u||(0,i.w3)("player-state",{loading:!1})}return s||Y(e.index),function(e){q=e}(e),(0,o.lK)(e.index,t,d),u&&(0,i.w3)("track-start",{track:e,playlistId:t}),function(e){if("youtube"!==e.player){const{original:t,small:n,type:i}=(0,l.TT)(e.artworkId);navigator.mediaSession.metadata=new MediaMetadata({title:e.title,artist:e.artist,album:e.album,artwork:[{src:t.url,sizes:"512x512",type:i},{src:n.url,sizes:"256x256",type:i},{src:n.url,sizes:"128x128",type:i}]}),navigator.mediaSession.setPositionState({duration:e.durationInSeconds})}}(e),function(e,t){const n=(0,r.PL)("volume");"native"===e.player?m(e,n,t):"youtube"===e.player&&C(e,n,t)}(e,c),s?a.FZ({trackId:s.track.id,currentTime:0,playlistId:s.playlistId}):a.FZ({trackId:e.id,currentTime:c||0,playlistId:t}),e}function se(){oe((0,s.LR)(H).tracks[q.index],H)}function le(){const{player:e}=q;"native"===e?function(e){e?u.play():u.pause()}(B):"youtube"===e&&M(B)}function ce(){q&&ee(),H="",q=null,B=!0,navigator.mediaSession.playbackState="none",navigator.mediaSession.setPositionState(null),a.OM(),(0,i.w3)("reset-player")}function de(e){q&&("native"===q.player&&v(e),"youtube"===q.player&&function(e){x?T?g.cueVideoById(k.track.id,e):(clearTimeout(L),g.seekTo(e,!0)):E=e}(e))}function ue(e){q&&("native"===q.player?p(e):"youtube"===q.player&&R(e))}function fe(e){const t=(0,s.LR)(e);return t?.tracks.length>0}function me(){return V===U.length-1}function pe(e,t){let n=ve(e,t,!0);if(!n)return null;let i=e;for(;z.includes(n.index);)i+=e,n=ve(i,t,!0);return n}function ve(e,t,n){const i=(0,s.LR)(t);if(!i)return null;const r=function(e,t=!1){const n=(0,c.MU)();let i=n?n.playbackIndex:V;return i+=e,0===e?i=0:i>=U.length?t?i-=U.length:i=0:i<0&&(i=U.length-1),U[i]}(e,n);return i.tracks[r]}},568:(e,t,n)=>{n.d(t,{Eo:()=>l,GC:()=>p,HX:()=>w,LR:()=>c,Nt:()=>u,Ol:()=>b,cM:()=>s,i5:()=>f,qX:()=>d,tH:()=>v});var i=n(244);const r={},a={};let o=null;async function s(e){const t=(await e.getAll("playlists")).sort((e,t)=>e.createdAt-t.createdAt);o=e;for(const e of t)r[e.id]=e,a[e.id]={},e.tracks.length?(a[e.id].duration=y(e.tracks),a[e.id].thumbnail=(0,i.Bu)(e.tracks),w(e)):(a[e.id].duration="0 hr 0 min",a[e.id].thumbnail=["assets/images/album-art-placeholder.png"],a[e.id].sortOrder=[])}function l(){return{...r}}function c(e){return r[e]}function d(e){return a[e]}function u(e){const t={tracks:[],createdAt:Date.now(),sortBy:"index",sortOrder:1,...e};return a[t.id]={thumbnail:["assets/images/album-art-placeholder.png"],duration:"0 hr 0 min",sortOrder:[]},t.tracks.length&&(a[t.id].duration=y(t.tracks),a[t.id].thumbnail=(0,i.Bu)(t.tracks),"search"!==t.id&&(t.tracks=b(t.tracks)),w(t)),r[t.id]=t,"local-files"!==t.id&&"search"!==t.id&&o.put("playlists",t),t}function f(e,t,{done:n=!0,sort:o=!0}={}){return r[e]={...r[e],...t},t.tracks&&(a[e].duration=y(t.tracks),n&&(a[e].thumbnail=(0,i.Bu)(t.tracks),o&&w(r[e]))),"local-files"===e||"search"===e?localStorage.setItem(e,JSON.stringify({sortBy:r[e].sortBy,sortOrder:r[e].sortOrder,viewMode:r[e].viewMode})):(m(e,t),(0,i.L_)(r)),r[e]}async function m(e,t){const n=await o.get("playlists",e);Object.keys(t).forEach(e=>{n[e]=t[e]}),o.put("playlists",n)}function p(e,t,n=!0){const i=r[e],o=b(t,i.tracks.length),s=o.map(e=>e.index);return i.tracks=i.tracks.concat(o),a[e].sortOrder=a[e].sortOrder.concat(s),n&&"local-files"!==e&&m(e,{tracks:i.tracks}),i.tracks}function v(e){return delete r[e],delete a[e],"local-files"!==e&&"search"!==e&&((0,i.L_)(r),o.delete("playlists",e)),r}function y(e){const t=function(e){return e.reduce((e,t)=>e+t.durationInSeconds,0)}(e);let n=Math.floor(t/3600),i=Math.ceil(t/60%60);return 60===i&&(i=0,n+=1),`${n} hr ${i} min`}function b(e,t=0){return e.map((e,n)=>(e.index=t+n,e))}function h(e,t){return"index"===e?t.index:"duration"===e?t.durationInSeconds:"date"===e?t.date:t[e].toLowerCase().replace(/[^\w\s]/gi,"")}function w({id:e,tracks:t,sortBy:n,sortOrder:i}){a[e].sortOrder=function(e,t,n){return[...e].sort((e,i)=>{const r=h(t,e),a=h(t,i);return r<a?-n:r>a?n:0}).map(({index:e})=>e)}(t,n,i)}},584:(e,t,n)=>{n.d(t,{m:()=>p,n:()=>v});var i=n(540),r=n(602),a=n(806),o=n(400),s=n(568),l=n(440),c=n(244),d=n(367),u=n(193),f=n(848);const m=(0,i.createContext)();function p({children:e}){const{showNotification:t}=(0,u.h)(),[p,v]=(0,i.useState)(null),y=(0,i.useMemo)(()=>({playlists:p,createPlaylist:j,updatePlaylist:L,removePlaylist:I,addTracks:N,uploadFiles:T,updatePlaylists:E}),[p]),b=(0,i.useRef)(!0),h=(0,i.useRef)(!1);async function w(e){const t=JSON.parse(localStorage.getItem("local-files"))||null,n=s.Eo(),i=s.Nt({id:"local-files",title:"Local Files",viewMode:"compact",tracks:(0,d._D)(e,[]),...t});v({...n,"local-files":{...i}}),(0,a.w3)("update-indicator-status",{id:"local-files",visible:!0}),await(0,d.RM)(i.tracks),(0,a.w3)("update-indicator-status",{id:"local-files",visible:!1})}function g({detail:e}){h.current?h.current=!1:T(e)}function k({detail:{track:e,done:t}}){const{id:n,tracks:i}=p["local-files"],r=i.findIndex(({id:t})=>e.id===t);r>=0&&(i[r]=e,L(n,{tracks:i,idle:t},{done:t,sort:t}))}function x({detail:{id:e,tracks:t,done:n}}){N(e,t,n),(0,a.w3)("tracks",{id:e,tracks:t})}async function T(e){const n="local-files",i=p[n],r=i?i.tracks:[],o=(0,d._D)(e,r);if(o.length){if((0,a.w3)("update-indicator-status",{id:n,visible:!0}),i)N(n,o,!1),(0,a.w3)("tracks",{id:n,tracks:o});else{j({id:n,title:"Local Files",viewMode:"compact",tracks:o,...JSON.parse(localStorage.getItem(n))||null})}await(0,d.RM)(o)}else t({value:"No unique files found."});(0,a.w3)("update-indicator-status",{id:n,visible:!1})}function j(e){const t=s.Nt(e);return v({...p,[e.id]:t}),t}function L(e,t,n){const i=s.i5(e,t,n);return v({...p,[e]:i}),i}function E(e){v({...p,...e})}function I(e){const t=s.tH(e);v({...t})}function N(e,t,n){const i=l.Qg();L(e,{tracks:s.GC(e,t,!1)},{done:n}),e===i&&l.Gx(i,l.gc())}return(0,i.useEffect)(()=>{!async function(){const e=(0,d.vf)(),t=await async function(){let e=null;try{e=await(0,r.P2)("veery",1,{upgrade(e){e.createObjectStore("artworks",{keyPath:"id"}),e.createObjectStore("playlists",{keyPath:"id"})}})}catch{e=await new Promise(e=>{indexedDB.deleteDatabase("veery").onsuccess=function(){e((0,r.P2)("veery",1,{upgrade(e){e.createObjectStore("artworks",{keyPath:"id"}),e.createObjectStore("playlists",{keyPath:"id"})}}))}})}return e}();if(await Promise.all([c.mN(t),s.cM(t)]),e.length)return void w(e);h.current=!0,window.addEventListener("file-handler",async({detail:e})=>{await w(e),h.current=!1},{once:!0}),v(s.Eo())}()},[]),(0,i.useEffect)(()=>{if(p)return b.current&&(b.current=!1,async function(){for(const{id:e,sync:t}of Object.values(p))if(t){(0,a.w3)("update-indicator-status",{id:e,visible:!0});const{initGoogleAPI:t,fetchPlaylistItems:i}=await n.e(17).then(n.bind(n,17)),r=await t(),c=await i(e,"sync"),d=l.yu(),u=l.Qg();L(e,{tracks:s.Ol(c)}),e===u&&(l.Gx(e),d&&((0,o.cb)(),(0,o.lK)(d.index,e))),(0,a.w3)("youtube-user-update",r),(0,a.w3)("tracks",{id:e,type:"replace"}),(0,a.w3)("update-indicator-status",{id:e,visible:!1})}}()),p["local-files"]&&window.addEventListener("track",k),window.addEventListener("youtube-tracks",x),window.addEventListener("file-handler",g),()=>{window.removeEventListener("track",k),window.removeEventListener("youtube-tracks",x),window.removeEventListener("file-handler",g)}},[p]),(0,f.jsx)(m,{value:y,children:e})}function v(){return(0,i.use)(m)}},719:(e,t,n)=>{n.d(t,{x:()=>l,z:()=>s});var i=n(540),r=n(855),a=n(848);const o=(0,i.createContext)();function s({children:e}){const[t,n]=(0,i.useState)([]),s=(0,i.useMemo)(()=>({queue:t,enqueueTracks:l,resetQueue:c,dequeueTrack:u,getNextQueueItem:f,getQueueItemAtIndex:m,removePlaylistItems:d}),[t]);function l(e){n([...r.fp(e)])}function c(){r.ld(),n([])}function d(e){const t=r.DJ(e);n(t)}function u(e){const t=r.Q3(e);n([...t])}function f(){const e=r.YQ();if(e)return n([...e.queue]),e;t.length&&n([])}function m(e){const{queue:t,track:i}=r.Se(e);return n([...t]),i}return(0,a.jsx)(o,{value:s,children:e})}function l(){return(0,i.use)(o)}},806:(e,t,n)=>{n.d(t,{$f:()=>d,R3:()=>c,Zc:()=>i,fU:()=>l,w3:()=>r,wE:()=>a,xW:()=>o});const i=function(){const e=[];return{load:function(t){return e.includes(t.src)?Promise.resolve():new Promise(n=>{const i=document.createElement("script");Object.keys(t).forEach(e=>{i.setAttribute(e,t[e])}),document.getElementsByTagName("body")[0].appendChild(i),e.push(t.src),i.onload=n})}}}();function r(e,t){const n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)}function a(e){const t=window.matchMedia("(display-mode: standalone)").matches;document.title=t?e:e?`${e} | Veery`:"Veery"}function o(...e){return e.join(" ").trimEnd()}function s(e,t=!0){return t&&e<10?`0${e}`:e}function l(e,t=!1){const n=function(e){return Math.floor(e/3600)}(e),i=function(e){return Math.floor(e/60%60)}(e),r=function(e){return e%60}(e);return`${(t=t||n)?`${n}:`:""}${s(i,t)}:${s(r)}`}function c(e){let t=e.length;for(;t;){const n=Math.floor(Math.random()*t);t-=1,[e[t],e[n]]=[e[n],e[t]]}return e}function d(e=8){return Math.random().toString(32).slice(2,2+e)}},855:(e,t,n)=>{n.d(t,{DJ:()=>u,MU:()=>a,Q3:()=>d,Se:()=>l,U4:()=>o,YQ:()=>s,fp:()=>c,ld:()=>f});let i=[],r=null;function a(){return r}function o(e){r=e}function s(){const e=i.shift();return e?{queue:i,track:e.track,playlistId:e.playlistId}:null}function l(e){const t=i[e];return i=i.slice(e+1),{queue:i,track:t.track}}function c(e){return i=i.concat(e),i}function d(e){return i.splice(e,1),i}function u(e){return i=i.filter(({playlistId:t})=>t!==e),i}function f(){i.length=0}},955:(e,t,n)=>{n.d(t,{C_:()=>O,Hb:()=>y,I$:()=>b,Xk:()=>q,b9:()=>H,gE:()=>L,jk:()=>R,lV:()=>E,mc:()=>j});var i=n(806),r=n(568),a=n(400);let o={},s={},l=-1,c=!1,d=null,u=null,f=0,m=0,p=0,v=!1;function y(e,t){b(),o.offsetY="grid"===t?0:40,o.element=e,e.addEventListener("pointerdown",h)}function b(){o.element&&(l=-1,o.element.removeEventListener("pointerdown",h),o={})}function h(e){if(1!==e.which)return;const t=window.matchMedia("(hover: hover) and (pointer: fine)").matches;if(window.removeEventListener("pointerup",k),t){if(e.target.closest(".artwork-btn"))return(0,i.w3)("selection",!1),void I();!function(e){const{top:t,left:n,height:i}=e.getBoundingClientRect();o.rect={top:t,left:n,width:e.clientWidth-1,height:i,scrollHeight:e.scrollHeight}}(e.currentTarget);const t={};t.x=e.clientX-o.rect.left,t.y=e.currentTarget.scrollTop+e.clientY-o.rect.top,t.x<o.rect.width&&t.y>e.currentTarget.scrollTop+o.offsetY&&(s.startingPoint=t,window.addEventListener("pointermove",w),window.addEventListener("pointerup",g))}else{if(window.addEventListener("contextmenu",x,{once:!0}),e.target.closest(".artwork-btn"))return v=!1,(0,i.w3)("selection",!1),I(),void window.removeEventListener("pointerup",k);if(v){const t=e.target.closest(".track");t&&N(t,!0)}else window.addEventListener("pointercancel",T,{once:!0}),window.addEventListener("pointerup",T,{once:!0}),p=setTimeout(()=>{const t=e.target.closest(".track");t&&(N(t,!0),v=!0)},1e3)}}function w(e){c||(c=!0,f=requestAnimationFrame(()=>{const{top:t,left:n,width:r,height:a,scrollHeight:l}=o.rect,f=e.clientY-t;if(d={x:S(e.clientX-n,{min:0,max:r}),y:S(o.element.scrollTop+f,{min:o.offsetY,max:l})},s.element)if(P(),$(e.ctrlKey),m)f>o.offsetY&&f<a&&A();else{let t=null;if(f>a&&d.y<l?t=M:f<o.offsetY&&d.y>o.offsetY&&(t=C),t){let n=1;m=setInterval(()=>{t(e.ctrlKey,n),n=n<5?1.05*n:n},40)}}else((p=d).x>s.startingPoint.x+2||p.x<s.startingPoint.x-2||p.y>s.startingPoint.y+2||p.y<s.startingPoint.y-2)&&(!function(){const{children:e}=o.element.lastElementChild;u=Array.from(e).map(e=>{const t=e.offsetTop,n=e.offsetLeft;return{elementRef:e,top:t,left:n,right:n+e.offsetWidth,bottom:t+e.offsetHeight}})}(),s.area={top:s.startingPoint.y,left:s.startingPoint.x},o.element.insertAdjacentHTML("afterbegin",`\n    <div class="selection-area" style="top: ${s.startingPoint.y}px; left: ${s.startingPoint.x}px"></div>\n  `),s.element=o.element.firstElementChild,e.ctrlKey||I(),window.removeEventListener("pointerup",k),(0,i.w3)("selection",!1));var p;c=!1}))}function g({target:e,ctrlKey:t,shiftKey:n}){if(f&&(cancelAnimationFrame(f),f=0,c=!1,m&&A()),s.element){const e=E();l=-1,s.element.remove(),s={},u.length=0,e.length&&(window.addEventListener("pointerup",k),(0,i.w3)("selection",!0))}else{const r=e.closest(".track");if(r){let e=0;for(const t of r.parentElement.children){if(t===r)break;e+=1}n&&-1!==l?l>=0&&l!==e&&function(e,t,n){const{children:i}=o.element.lastElementChild;e>t&&([e,t]=[t,e]);const r=[...i].slice(e,t+1);n||I();for(const e of r)e.classList.add("selected")}(l,e,t):(l=e,N(r,t))}else t||(l=-1,I(),(0,i.w3)("selection",!1))}window.removeEventListener("pointermove",w),window.removeEventListener("pointerup",g)}function k({target:e}){e.closest(".playlist-view")||e.closest(".js-selection-btn")||(v=!1,window.removeEventListener("pointerup",k),(0,i.w3)("selection",!1),I())}function x(e){e.preventDefault()}function T(){clearTimeout(p)}function j(){return v}function L(){v=!1,I(),window.removeEventListener("pointerup",k)}function E(){return o.element.querySelectorAll(".track.selected")}function I(){const e=E();for(const t of e)t.classList.remove("selected")}function N(e,t){if(t||I(),e.classList.toggle("selected"),e.classList.contains("selected"))(0,i.w3)("selection",!0),window.addEventListener("pointerup",k);else{0===E().length&&(v=!1,(0,i.w3)("selection",!1),window.removeEventListener("pointerup",k))}}function S(e,{min:t,max:n}){return e>n?n:e<t?t:e}function P(){const e=s.element.style;let t=d.x-s.startingPoint.x,n=d.y-s.startingPoint.y;if(t<0){const n=s.startingPoint.x+t;t*=-1,s.area.left=n,e.left=`${n}px`}else s.area.left!==s.startingPoint.x&&(s.area.left=s.startingPoint.x,e.left=`${s.startingPoint.x}px`);if(n<0){let t=s.startingPoint.y+n;t<o.offsetY&&(t=o.offsetY),n*=-1,s.area.top=t,e.top=`${t}px`}else s.area.top!==s.startingPoint.y&&(s.area.top=s.startingPoint.y,e.top=`${s.startingPoint.y}px`);s.area.right=s.area.left+t,s.area.bottom=s.area.top+n,e.width=`${t}px`,e.height=`${n}px`}function $(e){for(const t of u){const n=t.elementRef.classList;s.area.right>t.left&&s.area.left<t.right&&s.area.bottom>t.top&&s.area.top<t.bottom?(e&&!t.selected&&n.contains("selected")&&(n.remove("selected"),t.removed=!0),t.removed||(n.add("selected"),t.selected=!0)):t.selected?(n.remove("selected"),t.selected=!1):t.removed&&(n.add("selected"),t.removed=!1)}}function A(){clearInterval(m),m=0}function M(e,t){const{scrollHeight:n,height:i}=o.rect;o.element.scrollTop+=36*t,d.y=o.element.scrollTop+i,d.y>=n&&(d.y=n,A()),P(),$(e)}function C(e,t){o.element.scrollTop-=36*t,d.y=o.element.scrollTop,d.y<=0&&(d.y=0,A()),P(),$(e)}function O(){const e=(0,a.WM)()?".track:not(.hidden)":".track",t=o.element.querySelectorAll(e);if(t.length){for(const e of t)e.classList.add("selected");return window.addEventListener("pointerup",k),!0}}function R(e){return[...e].map(e=>Number(e.getAttribute("data-index")))}function H(e,{id:t,viewMode:n}){!function(e){for(const t of e)t.remove()}(e),function(e,t){const{sortOrder:n}=(0,r.qX)(e),{children:i}=o.element.lastElementChild;for(let e=0;e<i.length;e+=1){const r=i[e],a=n[e];if("grid"!==t){const t=r.querySelector(".track-index");t&&(t.textContent=e+1)}r.setAttribute("data-index",a)}}(t,n),window.removeEventListener("pointerup",k)}function q(e){const t=o.element.lastElementChild.children[e];t&&N(t)}}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,a),n.exports}a.m=i,e=[],a.O=(t,n,i,r)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){for(var[n,i,r]=e[d],s=!0,l=0;l<n.length;l++)(!1&r||o>=r)&&Object.keys(a.O).every(e=>a.O[e](n[l]))?n.splice(l--,1):(s=!1,r<o&&(o=r));if(s){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,i,r]},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,n)=>(a.f[n](e,t),t),[])),a.u=e=>e+".js",a.miniCssF=e=>e+".css",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="veery:",a.l=(e,i,r,o)=>{if(t[e])t[e].push(i);else{var s,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==n+r){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",n+r),s.src=e),t[e]=[i];var f=(n,i)=>{s.onerror=s.onload=null,clearTimeout(m);var r=t[e];if(delete t[e],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(e=>e(i)),n)return n(i)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),l&&document.head.appendChild(s)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{if("undefined"!=typeof document){var e=e=>new Promise((t,n)=>{var i=a.miniCssF(e),r=a.p+i;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),i=0;i<n.length;i++){var r=(o=n[i]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(r===e||r===t))return o}var a=document.getElementsByTagName("style");for(i=0;i<a.length;i++){var o;if((r=(o=a[i]).getAttribute("data-href"))===e||r===t)return o}})(i,r))return t();((e,t,n,i,r)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",a.nc&&(o.nonce=a.nc),o.onerror=o.onload=n=>{if(o.onerror=o.onload=null,"load"===n.type)i();else{var a=n&&n.type,s=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+s+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=s,o.parentNode&&o.parentNode.removeChild(o),r(l)}},o.href=t,n?n.parentNode.insertBefore(o,n.nextSibling):document.head.appendChild(o)})(e,r,null,t,n)}),t={792:0};a.f.miniCss=(n,i)=>{t[n]?i.push(t[n]):0!==t[n]&&{79:1,144:1,381:1,429:1,626:1,627:1,695:1,746:1,957:1}[n]&&i.push(t[n]=e(n).then(()=>{t[n]=0},e=>{throw delete t[n],e}))}}})(),(()=>{a.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={792:0};a.f.j=(t,n)=>{var i=a.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise((n,r)=>i=e[t]=[n,r]);n.push(i[2]=r);var o=a.p+a.u(t),s=new Error;a.l(o,n=>{if(a.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",s.name="ChunkLoadError",s.type=r,s.request=o,i[1](s)}},"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[o,s,l]=n,c=0;if(o.some(t=>0!==e[t])){for(i in s)a.o(s,i)&&(a.m[i]=s[i]);if(l)var d=l(a)}for(t&&t(n);c<o.length;c++)r=o[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=globalThis.webpackChunkveery=globalThis.webpackChunkveery||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=a.O(void 0,[121],()=>a(335));o=a.O(o)})();