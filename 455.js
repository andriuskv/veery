"use strict";(globalThis.webpackChunkveery=globalThis.webpackChunkveery||[]).push([[455],{513:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(294),i=n(353),o=n(461),r=n(893);const l=function({container:e,toggle:t={},body:n,children:l}){const[a,c]=(0,s.useState)({id:(0,i.zO)()}),d=(0,s.useCallback)((function({target:e}){const t=e.closest(".dropdown-container");let n=!0;t?.id===a.id&&(n=!e.closest("[data-dropdown-keep]")&&(e.closest("a")||e.closest(".dropdown-btn")));n&&(u.current&&c({id:a.id,visible:!1,reveal:!1}),window.removeEventListener("click",d))}),[a.id]),u=(0,s.useRef)(!1),f=(0,s.useRef)(null);return(0,s.useEffect)((()=>(u.current=!0,()=>{u.current=!1,window.removeEventListener("click",d)})),[d]),(0,s.useLayoutEffect)((()=>{if(a.reveal){let e=!1;if(a.data){const t=f.current.getBoundingClientRect().height+8;a.data.bottom+t>a.data.height&&a.data.top>t&&(e=!0)}c({...a,onTop:e,visible:!0})}}),[a.reveal]),(0,r.jsxs)("div",{id:a.id,className:`dropdown-container${e?` ${e.className}`:""}${a.visible?" visible":""}`,children:[(0,r.jsx)("button",{className:`btn icon-btn${t.className?` ${t.className}`:""}${a.visible?" active":""}`,onClick:function({currentTarget:e}){let t=null;if(a.visible)window.removeEventListener("click",d);else{const n=e.parentElement,s=function(e){for(;e&&!e.hasAttribute("data-dropdown-parent");)e=e.parentElement;return e}(n);s&&(s.style.position="relative",t={top:n.offsetTop,bottom:n.offsetTop+n.offsetHeight,height:s.scrollTop+s.clientHeight},s.style.position=""),window.addEventListener("click",d)}c({id:a.id,visible:!1,reveal:!a.visible,data:t,onTop:!1})},title:t.title||"More",children:t.body?t.body:(0,r.jsx)(o.Z,{id:t.iconId||"vertical-dots",className:"dropdown-toggle-btn-icon"})}),(0,r.jsx)("div",{ref:f,className:`container dropdown${n?` ${n.className}`:""}${a.reveal?" reveal":""}${a.visible?" visible":""}${a.onTop?" top":""}`,children:l})]})}},455:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var s=n(294),i=n(974),o=n(676),r=n(106),l=n(768),a=n(615),c=n(500),d=n(322),u=n(722),f=n(253),p=n(461),m=n(893);const v=function({playlistId:e,setMessage:t}){const[n,i]=(0,s.useState)(!1),[r,l]=(0,s.useState)(""),a=(0,s.useRef)(0);return(0,s.useEffect)((()=>()=>{l(""),i(!1),(0,o.gI)("")}),[e]),n?(0,m.jsx)("div",{className:"playlist-toolbar-search",children:(0,m.jsxs)("div",{className:"playlist-toolbar-search-input-container",children:[(0,m.jsx)(p.Z,{id:"search",className:"playlist-toolbar-search-input-icon"}),(0,m.jsx)("input",{type:"text",className:"input playlist-toolbar-search-input",placeholder:"Search",value:r,onChange:function({target:n}){l(n.value),(0,o.gI)(n.value),clearTimeout(a.current),a.current=setTimeout((()=>{const s=(0,o.BM)(n.value,e);t(s?"":"No tracks found")}),400)},onKeyDown:function({target:e,key:t}){"Enter"===t&&e.blur()},autoFocus:!0}),(0,m.jsx)("button",{className:"btn icon-btn playlist-toolbar-search-reset-btn",onClick:function(){l(""),t(""),i(!1),(0,o.gI)(""),(0,o.xU)(e)},title:"Clear",children:(0,m.jsx)(p.Z,{id:"close"})})]})}):(0,m.jsxs)("button",{className:"btn icon-text-btn",onClick:function(){i(!0)},children:[(0,m.jsx)(p.Z,{id:"search"}),(0,m.jsx)("span",{children:"Search"})]})},h=(0,s.lazy)((()=>n.e(911).then(n.bind(n,911))));const w=function({playlist:e,playlistRef:t,setMessage:n}){const{updatePlaylist:i}=(0,a.K)(),{activePlaylistId:p}=(0,c.n)(),[w,y]=(0,s.useState)(!1);function g(t){const n=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey,{target:s,key:i}=t;if(!(s instanceof HTMLInputElement&&"text"===s.type))if("Delete"!==i||n){if("a"===i&&t.ctrlKey&&(t.preventDefault(),e.tracks.length)){const e=(0,r.GM)();y(e)}}else j(),y(!1)}function b({detail:e}){y(e)}function x(){y(!1)}function j(){const t=(0,r.eD)(),n=(0,r.YP)(t),s=[];for(const t of e.tracks)n.includes(t.index)||s.push(t);if(i(e.id,{tracks:(0,d.jg)(s)}),(0,r.wR)(t,e),e.id===p){(0,l.X5)(e.id);const t=(0,l.t7)();t&&(0,o.ul)(t.index,e.id)}x()}return(0,s.useEffect)((()=>(window.addEventListener("keydown",g),window.addEventListener("selection",b),()=>{window.removeEventListener("keydown",g),window.removeEventListener("selection",b)})),[e,p]),(0,m.jsxs)("div",{className:"playlist-toolbar",children:[(0,m.jsx)(u.Z,{startViewMode:e.viewMode,changeViewMode:function(n){e.viewMode=n,i(e.id,{viewMode:n}),(0,o.U)(t.current,e),(0,r.Uk)(t.current,e)}}),w&&(0,m.jsx)(s.Suspense,{fallback:null,children:(0,m.jsx)(h,{playlist:e,removeSelectedTracks:j,hide:x})}),(0,m.jsx)(v,{playlistId:e.id,setMessage:n}),(0,m.jsx)(f.Z,{playlist:e,playlistRef:t,updateSortedPlaylist:function({sortBy:t,sortOrder:n}){(0,l.ZO)(e.tracks,e.id),i(e.id,{sortBy:t,sortOrder:n})}})]})};const y=function(){const{id:e}=(0,i.UO)(),{playlists:t,updatePlaylist:n}=(0,a.K)(),{activePlaylistId:d,togglePlay:u,playAtIndex:f}=(0,c.n)(),[p,v]=(0,s.useState)(null),[h,y]=(0,s.useState)(!0),[g,b]=(0,s.useState)(""),x=(0,s.useRef)(!1),j=(0,s.useRef)(null);function k({detail:{track:t}}){(0,o.z4)(t,e)}function N({detail:{id:t,tracks:n}}){t===e&&(0,o.tI)(n,j.current,p)}return(0,s.useEffect)((()=>()=>{x.current=!1,b(""),(0,o.yW)(),(0,r.Kh)()}),[e]),(0,s.useEffect)((()=>{t&&(y(!1),v(t[e]))}),[t,e]),(0,s.useLayoutEffect)((()=>{if(p)if(x.current)p.tracks.length||((0,o.yW)(),(0,r.Kh)());else{if(window.matchMedia("(max-width: 700px)").matches&&"grid"!==p.viewMode)return void n(p.id,{viewMode:"grid"});(0,o.U)(j.current,p),(0,r.Uk)(j.current,p),(0,o.O9)(e),x.current=!0}}),[p]),(0,s.useEffect)((()=>("local-files"===e?window.addEventListener("track",k):window.addEventListener("youtube-tracks",N),()=>{window.removeEventListener("track",k),window.removeEventListener("youtube-tracks",N)})),[p]),!t||h?null:p?(0,m.jsxs)("div",{className:"playlist"+(p.tracks.length&&!g?"":" empty"),children:[(0,m.jsx)(w,{playlist:p,playlistRef:j,setMessage:b}),(0,m.jsx)("div",{className:"playlist-view",ref:j,onClick:function({target:t,detail:n}){const s=t.closest(".track");if(s)if(2===n){const t=Number(s.getAttribute("data-index"));f(t,e)}else{if(!t.closest(".artwork-btn"))return;const n=Number(s.getAttribute("data-index")),i=(0,l.t7)();i&&d===e&&n===i.index?u():f(n,e)}}}),p.tracks.length?g?(0,m.jsx)("p",{className:"playlist-message",children:g}):null:(0,m.jsx)("p",{className:"playlist-message",children:"Playlist is empty"})]}):(0,m.jsx)("div",{className:"playlist empty",children:(0,m.jsx)("p",{className:"playlist-message",children:"Playlist not found"})})}},253:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(294),i=n(322),o=n(676),r=n(461),l=n(513),a=n(893);const c=function({playlist:e,playlistRef:t,updateSortedPlaylist:n}){const[c,d]=(0,s.useState)({sortBy:e.sortBy,sortOrder:e.sortOrder});function u({target:e}){f(c.sortBy,Number(e.value))}function f(s,r=1){s===c.sortBy&&r===c.sortOrder||(n({sortBy:s,sortOrder:r}),(0,i.Yr)({...e,sortBy:s,sortOrder:r}),d({sortBy:s,sortOrder:r}),(0,o.U)(t.current,e))}return(0,s.useEffect)((()=>{d({sortBy:e.sortBy,sortOrder:e.sortOrder})}),[e]),(0,a.jsxs)(l.Z,{toggle:{body:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z,{id:"sort"}),(0,a.jsx)("span",{children:"Sort"})]}),className:"icon-text-btn sort-dropdown-toggle-btn"},container:{className:"sort-dropdown-container"},children:[(0,a.jsxs)("div",{className:"sort-dropdown-group",children:[(0,a.jsx)("button",{className:"btn text-btn dropdown-btn sort-dropdown-btn"+("index"===c.sortBy?" active":""),onClick:()=>f("index"),children:"Index"}),(0,a.jsx)("button",{className:"btn text-btn dropdown-btn sort-dropdown-btn"+("title"===c.sortBy?" active":""),onClick:()=>f("title"),children:"Title"}),(0,a.jsx)("button",{className:"btn text-btn dropdown-btn sort-dropdown-btn"+("artist"===c.sortBy?" active":""),onClick:()=>f("artist"),children:"Artist"}),(0,a.jsx)("button",{className:"btn text-btn dropdown-btn sort-dropdown-btn"+("album"===c.sortBy?" active":""),onClick:()=>f("album"),children:"Album"}),(0,a.jsx)("button",{className:"btn text-btn dropdown-btn sort-dropdown-btn"+("duration"===c.sortBy?" active":""),onClick:()=>f("duration"),children:"Duration"})]}),(0,a.jsxs)("div",{className:"sort-dropdown-group",children:[(0,a.jsxs)("label",{className:"dropdown-btn sort-dropdown-radio",children:[(0,a.jsx)("input",{type:"radio",className:"sr-only radio-input",name:"sortOrder",value:"1",onChange:u,checked:1===c.sortOrder}),(0,a.jsx)("div",{className:"radio"}),(0,a.jsx)("span",{className:"radio-label",children:"Ascending"})]}),(0,a.jsxs)("label",{className:"dropdown-btn sort-dropdown-radio",children:[(0,a.jsx)("input",{type:"radio",className:"sr-only radio-input",onChange:u,name:"sortOrder",value:"-1",checked:-1===c.sortOrder}),(0,a.jsx)("div",{className:"radio"}),(0,a.jsx)("span",{className:"radio-label",children:"Descending"})]})]})]})}},722:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(294),i=n(461),o=n(893);const r=function({startViewMode:e,changeViewMode:t,hideMinimal:n=!1}){const[r,l]=(0,s.useState)(e);function a(e){l(e.target.value),t(e.target.value)}return(0,s.useEffect)((()=>{l(e)}),[e]),(0,o.jsxs)("ul",{className:"view-modes",children:[n?null:(0,o.jsx)("li",{className:"view-mode-container",children:(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"radio",className:"sr-only view-mode-radio-input",name:"view-mode",value:"minimal",checked:"minimal"===r,onChange:a}),(0,o.jsx)(i.Z,{id:"minimal",className:"btn icon-btn view-mode-icon",title:"Minimal"})]})}),(0,o.jsx)("li",{className:"view-mode-container",children:(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"radio",className:"sr-only view-mode-radio-input",name:"view-mode",value:"compact",checked:"compact"===r,onChange:a}),(0,o.jsx)(i.Z,{id:"compact",className:"btn icon-btn view-mode-icon",title:"Compact"})]})}),(0,o.jsx)("li",{className:"view-mode-container",children:(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"radio",className:"sr-only view-mode-radio-input",name:"view-mode",value:"grid",checked:"grid"===r,onChange:a}),(0,o.jsx)(i.Z,{id:"grid",className:"btn icon-btn view-mode-icon",title:"Grid"})]})})]})}},106:(e,t,n)=>{n.d(t,{Uk:()=>h,Kh:()=>w,Mt:()=>N,YP:()=>K,eD:()=>E,GM:()=>B,wR:()=>A});var s=n(353),i=n(322),o=n(676);let r={},l={},a=-1,c=!1,d=null,u=null,f=0,p=0,m=0,v=!1;function h(e,{viewMode:t,tracks:n}){w(),n.length&&(r.offsetY="grid"===t?0:40,r.element=e,e.addEventListener("pointerdown",y))}function w(){r.element&&(a=-1,r.element.removeEventListener("pointerdown",y),r={})}function y(e){if(1!==e.which)return;const t=window.matchMedia("(hover: hover) and (pointer: fine)").matches;if(window.removeEventListener("pointerup",x),t){if(e.target.closest(".artwork-btn"))return(0,s.hb)("selection",!1),void L();n=e.currentTarget,r.rect={top:n.offsetTop,left:n.offsetLeft,width:n.clientWidth-1,height:n.offsetHeight,scrollHeight:n.scrollHeight};const t={};t.x=e.clientX-r.rect.left,t.y=e.currentTarget.scrollTop+e.clientY-r.rect.top,t.x<r.rect.width&&t.y>e.currentTarget.scrollTop+r.offsetY&&(l.startingPoint=t,window.addEventListener("pointermove",g),window.addEventListener("pointerup",b))}else{if(window.addEventListener("contextmenu",j,{once:!0}),e.target.closest(".artwork-btn"))return v=!1,(0,s.hb)("selection",!1),L(),void window.removeEventListener("pointerup",x);if(v){const t=e.target.closest(".track");t&&P(t,!0)}else window.addEventListener("pointercancel",k,{once:!0}),window.addEventListener("pointerup",k,{once:!0}),m=setTimeout((()=>{const t=e.target.closest(".track");t&&(P(t,!0),v=!0)}),1e3)}var n}function g(e){c||(c=!0,f=requestAnimationFrame((()=>{const{top:t,left:n,width:i,height:o,scrollHeight:a}=r.rect,f=e.clientY-t;if(d={x:T(e.clientX-n,{min:0,max:i}),y:T(r.element.scrollTop+f,{min:r.offsetY,max:a})},l.element)if(C(),M(e.ctrlKey),p)f>r.offsetY&&f<o&&S();else{let t=null;f>o&&d.y<a?t=O:f<r.offsetY&&d.y>r.offsetY&&(t=$),t&&(p=setInterval(t,40,e.ctrlKey))}else((m=d).x>l.startingPoint.x+2||m.x<l.startingPoint.x-2||m.y>l.startingPoint.y+2||m.y<l.startingPoint.y-2)&&(!function(){const{children:e}=r.element.lastElementChild;u=Array.from(e).map((e=>{const t=e.offsetTop,n=e.offsetLeft;return{elementRef:e,top:t,left:n,right:n+e.offsetWidth,bottom:t+e.offsetHeight}}))}(),l.area={top:l.startingPoint.y,left:l.startingPoint.x},r.element.insertAdjacentHTML("afterbegin",`\n    <div class="selection-area" style="top: ${l.startingPoint.y}px; left: ${l.startingPoint.x}px"></div>\n  `),l.element=r.element.firstElementChild,e.ctrlKey||L(),window.removeEventListener("pointerup",x),(0,s.hb)("selection",!1));var m;c=!1})))}function b({target:e,ctrlKey:t,shiftKey:n}){if(f&&(cancelAnimationFrame(f),f=0,c=!1,p&&S()),l.element){const e=E();a=-1,l.element.remove(),l={},u.length=0,e.length&&(window.addEventListener("pointerup",x),(0,s.hb)("selection",!0))}else{const i=e.closest(".track");if(i){let e=0;for(const t of i.parentElement.children){if(t===i)break;e+=1}n&&-1!==a?a>=0&&a!==e&&function(e,t,n){const{children:s}=r.element.lastElementChild;e>t&&([e,t]=[t,e]);const i=[...s].slice(e,t+1);n||L();for(const e of i)e.classList.add("selected")}(a,e,t):(a=e,P(i,t))}else t||(a=-1,L(),(0,s.hb)("selection",!1))}window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",b)}function x({target:e}){e.closest(".playlist-view")||e.closest(".js-selection-btn")||(v=!1,window.removeEventListener("pointerup",x),(0,s.hb)("selection",!1),L())}function j(e){e.preventDefault()}function k(){clearTimeout(m)}function N(){v=!1,L(),window.removeEventListener("pointerup",x)}function E(){return r.element.querySelectorAll(".track.selected")}function L(){const e=E();for(const t of e)t.classList.remove("selected")}function P(e,t){if(t||L(),e.classList.toggle("selected"),e.classList.contains("selected"))(0,s.hb)("selection",!0),window.addEventListener("pointerup",x);else{0===E().length&&(v=!1,(0,s.hb)("selection",!1),window.removeEventListener("pointerup",x))}}function T(e,{min:t,max:n}){return e>n?n:e<t?t:e}function C(){const e=l.element.style;let t=d.x-l.startingPoint.x,n=d.y-l.startingPoint.y;if(t<0){const n=l.startingPoint.x+t;t*=-1,l.area.left=n,e.left=`${n}px`}else l.area.left!==l.startingPoint.x&&(l.area.left=l.startingPoint.x,e.left=`${l.startingPoint.x}px`);if(n<0){let t=l.startingPoint.y+n;t<r.offsetY&&(t=r.offsetY),n*=-1,l.area.top=t,e.top=`${t}px`}else l.area.top!==l.startingPoint.y&&(l.area.top=l.startingPoint.y,e.top=`${l.startingPoint.y}px`);l.area.right=l.area.left+t,l.area.bottom=l.area.top+n,e.width=`${t}px`,e.height=`${n}px`}function M(e){for(const t of u){const n=t.elementRef.classList;l.area.right>t.left&&l.area.left<t.right&&l.area.bottom>t.top&&l.area.top<t.bottom?(e&&!t.selected&&n.contains("selected")&&(n.remove("selected"),t.removed=!0),t.removed||(n.add("selected"),t.selected=!0)):t.selected?(n.remove("selected"),t.selected=!1):t.removed&&(n.add("selected"),t.removed=!1)}}function S(){clearInterval(p),p=0}function O(e){const{scrollHeight:t,height:n}=r.rect;r.element.scrollTop+=36,d.y=r.element.scrollTop+n,d.y>=t&&(d.y=t,S()),C(),M(e)}function $(e){r.element.scrollTop-=36,d.y=r.element.scrollTop,d.y<=0&&(d.y=0,S()),C(),M(e)}function B(){const e=(0,o.SI)()?".track:not(.hidden)":".track",t=r.element.querySelectorAll(e);if(t.length){for(const e of t)e.classList.add("selected");return window.addEventListener("pointerup",x),!0}}function K(e){return[...e].map((e=>Number(e.getAttribute("data-index"))))}function A(e,{id:t,viewMode:n}){!function(e){for(const t of e)t.remove()}(e),function(e,t){const{sortOrder:n}=(0,i.mP)(e),{children:s}=r.element.lastElementChild;for(let e=0;e<s.length;e+=1){const i=s[e],o=n[e];if("grid"!==t){const t=i.querySelector(".track-index");t&&(t.textContent=e+1)}i.setAttribute("data-index",o)}}(t,n),window.removeEventListener("pointerup",x)}}}]);