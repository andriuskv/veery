"use strict";(globalThis.webpackChunkveery=globalThis.webpackChunkveery||[]).push([[466],{466:(t,e,i)=>{i.r(e),i.d(e,{default:()=>b});var s=i(294),l=i(974),a=i(353),n=i(7),o=i(322),d=i(615),c=i(461),u=i(893);const r=function({children:t,hide:e}){let i=null;function l(t){"Escape"===t.key&&e()}return(0,s.useEffect)((()=>(window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)})),[]),(0,u.jsx)("div",{className:"modal-mask",onPointerDown:function(t){t.target===t.currentTarget&&(i=t.target)},onPointerUp:function(t){i===t.currentTarget&&e(),i=null},children:(0,u.jsx)("div",{className:"modal",children:t})})};const m=function({notification:t,dismiss:e}){const[i,l]=(0,s.useState)(t);return(0,s.useEffect)((()=>{if(!i.flashing&&i!==t){if(i.value!==t.value)return void l(t);l({...i,flashing:!0}),setTimeout((()=>{l(t)}),640)}}),[i,t]),(0,u.jsxs)("div",{className:(0,a.AK)("notification","negative",i.flashing?"flash":""),children:[(0,u.jsx)(c.Z,{id:"circle-close",className:"notification-icon"}),(0,u.jsx)("span",{className:"notification-text",children:i.value}),(0,u.jsx)("button",{type:"button",className:"btn icon-btn notification-dismiss-btn",onClick:e,title:"Dismiss",children:(0,u.jsx)(c.Z,{id:"close",className:"notification-dismiss-btn-icon"})})]})};const b=function({youtube:t,setYoutube:e}){const i=(0,l.TH)(),{createPlaylist:b,addTracks:h}=(0,d.K)(),[y,f]=(0,s.useState)(null),[v,p]=(0,s.useState)(!1);async function x(s){let l=null;try{({searchParams:l}=new URL(s))}catch{return void f({value:"Invalid URL."})}const d=l.get("list"),c=l.get("v");if(d||c)if("WL"!==d){if(p(!0),d){const l=(0,o.hT)(d);if((0,a.hb)("update-indicator-status",{id:d,visible:!0}),l)delete t.modalVisible,e({...t,playlistId:d,loading:!0});else{const i=await(0,n.fetchPlaylistTitleAndStatus)(d);if(!i)return p(!1),void f({value:"Playlist was not found."});delete t.modalVisible,e({...t,playlistId:d,loading:!0}),b({id:d,sync:!1,viewMode:"grid",url:s,...i})}await(0,n.fetchPlaylistItems)(d),"/"===i.pathname&&e({...t,loading:!1}),(0,a.hb)("update-indicator-status",{id:d,visible:!1})}else if(c){const i="youtube-videos",s=(0,o.hT)(i),l=await(0,n.addVideo)(c,s?s.tracks:[]);l?(delete t.modalVisible,e({...t}),s?h(s.id,l):b({id:i,title:"YouTube Videos",sync:!1,viewMode:"grid",tracks:l})):(p(!1),f({value:"Video was not found."}))}}else f({value:"Importing Watch Later playlist is not allowed."});else f({value:"Invalid URL."})}function j(){delete t.modalVisible,e({...t})}return(0,u.jsxs)(r,{hide:j,children:[(0,u.jsxs)("div",{className:"modal-header",children:[(0,u.jsx)(c.Z,{id:"youtube",className:"modal-header-icon"}),(0,u.jsx)("h3",{className:"modal-title",children:"YouTube Import"})]}),(0,u.jsxs)("form",{className:"youtube-modal-form",onSubmit:async function(t){t.preventDefault(),x(t.target.elements.url.value)},children:[(0,u.jsx)("input",{type:"text",className:"input youtube-modal-form-input",name:"url",placeholder:"Enter playlist or video URL",disabled:v,autoFocus:!0,required:!0}),(0,u.jsx)("button",{className:"btn text-btn youtube-modal-form-submit-btn",disabled:v,children:"Import"})]}),y&&(0,u.jsx)(m,{notification:y,dismiss:function(){f(null)}}),t.playlists?(0,u.jsx)("ul",{className:"youtube-modal-playlists",children:t.playlists.map((t=>(0,u.jsx)("li",{className:"youtube-modal-playlist",children:(0,u.jsxs)("button",{className:"btn youtube-modal-playlist-btn",onClick:()=>x(t.url),children:[(0,u.jsx)("div",{className:"youtube-modal-playlist-thumbnail-container artwork-container",children:(0,u.jsx)("img",{src:t.thumbnail,className:"artwork",alt:""})}),(0,u.jsxs)("div",{className:"youtube-modal-playlist-content",children:[(0,u.jsx)("div",{children:t.title}),(0,u.jsxs)("div",{className:"youtube-modal-playlist-bottom",children:[t.isPrivate?(0,u.jsx)("span",{className:"youtube-modal-playlist-bottom-item",children:(0,u.jsx)(c.Z,{id:"lock",className:"youtube-modal-playlist-bottom-icon",title:"Private to you"})}):null,(0,u.jsxs)("span",{className:"youtube-modal-playlist-bottom-item",children:[t.itemCount," track",1===t.itemCount?"":"s"]})]})]}),(0,u.jsx)("div",{className:"youtube-modal-playlist-action",children:"Import"})]})},t.id)))}):null,(0,u.jsx)("div",{className:"modal-bottom",children:(0,u.jsx)("button",{className:"btn text-btn",onClick:j,children:"Cancel"})})]})}}}]);